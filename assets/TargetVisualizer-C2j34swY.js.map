{"version":3,"file":"TargetVisualizer-C2j34swY.js","sources":["../../src/components/TargetVisualizer.ts"],"sourcesContent":["import { BaseComponent } from './base/BaseComponent.js';\nimport { sharedStyles } from './styles/shared.js';\n\nexport class TargetVisualizer extends BaseComponent {\n    static get observedAttributes(): string[] {\n        return ['target', 'actual', 'unit'];\n    }\n\n    protected getTemplate(): string {\n        return '';\n    }\n\n    protected onAttributeChanged(_name: string, _oldValue: string | null, _newValue: string | null): void {\n        this.render();\n    }\n\n    protected getStyles(): string {\n        return `\n            ${sharedStyles}\n            :host {\n                display: block;\n                width: 100%;\n                margin: 1rem 0;\n            }\n            .vis-container {\n                position: relative;\n                height: 40px;\n                background: var(--surface-2);\n                border-radius: 20px;\n                overflow: hidden;\n                border: 1px solid var(--color-border);\n            }\n            .center-line {\n                position: absolute;\n                left: 50%;\n                top: 0;\n                bottom: 0;\n                width: 2px;\n                background: var(--color-text-primary);\n                transform: translateX(-50%);\n                z-index: 2;\n            }\n            .target-zone {\n                position: absolute;\n                left: 40%;\n                width: 20%;\n                top: 0;\n                bottom: 0;\n                background: var(--color-success);\n                opacity: 0.2;\n                z-index: 1;\n            }\n            .actual-marker {\n                position: absolute;\n                top: 50%;\n                width: 16px;\n                height: 16px;\n                background: var(--color-primary);\n                border: 2px solid var(--surface-1);\n                border-radius: 50%;\n                transform: translate(-50%, -50%);\n                transition: left 0.3s ease-out;\n                z-index: 3;\n                box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n            }\n            .actual-marker.high {\n                background: var(--color-warning);\n            }\n            .actual-marker.low {\n                background: var(--color-info);\n            }\n            .labels {\n                display: flex;\n                justify-content: space-between;\n                font-size: 0.8rem;\n                color: var(--color-text-secondary);\n                margin-top: 4px;\n            }\n            .target-val {\n                font-weight: bold;\n                color: var(--color-text-primary);\n            }\n        `;\n    }\n\n    private formatPace(decimalMin: number): string {\n        if (isNaN(decimalMin)) return '--:--';\n        const min = Math.floor(decimalMin);\n        const sec = Math.round((decimalMin - min) * 60);\n        return `${min}:${sec.toString().padStart(2, '0')}`;\n    }\n\n    protected render(): void {\n        const target = parseFloat(this.getAttribute('target') || '0');\n        const actual = parseFloat(this.getAttribute('actual') || '0');\n        const unit = this.getAttribute('unit') || 'W';\n        const isPace = unit === 'min_km' || unit === 'min_mile';\n\n        // Calculate position\n        // Center (50%) represents the target\n        // Range is +/- 50% of target\n        // e.g. Target 200. Max display 300, Min display 100.\n\n        let percentage = 50;\n        let diffClass = '';\n\n        if (target > 0) {\n            let diff = actual - target;\n\n            // For pace, negative diff (faster) implies higher intensity/right side\n            if (isPace) {\n                diff = -diff;\n            }\n\n            const maxTrackableDiff = target * 0.5; // Visual range is +/- 50%\n\n            // Normalize diff to -50...50 range based on maxTrackableDiff\n            let visualDiff = (diff / maxTrackableDiff) * 50;\n\n            // Clamp to -50...50\n            visualDiff = Math.max(-50, Math.min(50, visualDiff));\n\n            percentage = 50 + visualDiff;\n\n            // Determine color class based on percent deviation\n            const percentDev = Math.abs(diff / target);\n            if (percentDev > 0.1) {\n                diffClass = diff > 0 ? 'high' : 'low';\n            }\n        }\n\n        const displayTarget = isPace ? this.formatPace(target) : Math.round(target);\n        const displayUnit = unit === 'min_km' ? 'min/km' : unit === 'min_mile' ? 'min/mi' : unit;\n        const lowLabel = isPace ? 'Slow' : 'Low';\n        const highLabel = isPace ? 'Fast' : 'High';\n\n        this.shadow.innerHTML = `\n            <style>${this.getStyles()}</style>\n            <div class=\"vis-container\" role=\"img\" aria-label=\"Target visualization: ${actual}${unit} vs Target ${target}${unit}\">\n                <div class=\"target-zone\"></div>\n                <div class=\"center-line\"></div>\n                <div class=\"actual-marker ${diffClass}\" style=\"left: ${percentage}%\"></div>\n            </div>\n            <div class=\"labels\">\n                <span>${lowLabel}</span>\n                <span class=\"target-val\">Target: ${displayTarget} ${displayUnit}</span>\n                <span>${highLabel}</span>\n            </div>\n        `;\n    }\n}\n\ncustomElements.define('bpt-target-visualizer', TargetVisualizer);\n"],"names":["TargetVisualizer","BaseComponent","_name","_oldValue","_newValue","sharedStyles","decimalMin","min","sec","target","actual","unit","isPace","percentage","diffClass","diff","maxTrackableDiff","visualDiff","displayTarget","displayUnit","lowLabel","highLabel"],"mappings":"qOAGO,MAAMA,UAAyBC,CAAc,CAChD,WAAW,oBAA+B,CACtC,MAAO,CAAC,SAAU,SAAU,MAAM,CACtC,CAEU,aAAsB,CAC5B,MAAO,EACX,CAEU,mBAAmBC,EAAeC,EAA0BC,EAAgC,CAClG,KAAK,OAAA,CACT,CAEU,WAAoB,CAC1B,MAAO;AAAA,cACDC,CAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAiEtB,CAEQ,WAAWC,EAA4B,CAC3C,GAAI,MAAMA,CAAU,EAAG,MAAO,QAC9B,MAAMC,EAAM,KAAK,MAAMD,CAAU,EAC3BE,EAAM,KAAK,OAAOF,EAAaC,GAAO,EAAE,EAC9C,MAAO,GAAGA,CAAG,IAAIC,EAAI,WAAW,SAAS,EAAG,GAAG,CAAC,EACpD,CAEU,QAAe,CACrB,MAAMC,EAAS,WAAW,KAAK,aAAa,QAAQ,GAAK,GAAG,EACtDC,EAAS,WAAW,KAAK,aAAa,QAAQ,GAAK,GAAG,EACtDC,EAAO,KAAK,aAAa,MAAM,GAAK,IACpCC,EAASD,IAAS,UAAYA,IAAS,WAO7C,IAAIE,EAAa,GACbC,EAAY,GAEhB,GAAIL,EAAS,EAAG,CACZ,IAAIM,EAAOL,EAASD,EAGhBG,IACAG,EAAO,CAACA,GAGZ,MAAMC,EAAmBP,EAAS,GAGlC,IAAIQ,EAAcF,EAAOC,EAAoB,GAG7CC,EAAa,KAAK,IAAI,IAAK,KAAK,IAAI,GAAIA,CAAU,CAAC,EAEnDJ,EAAa,GAAKI,EAGC,KAAK,IAAIF,EAAON,CAAM,EACxB,KACbK,EAAYC,EAAO,EAAI,OAAS,MAExC,CAEA,MAAMG,EAAgBN,EAAS,KAAK,WAAWH,CAAM,EAAI,KAAK,MAAMA,CAAM,EACpEU,EAAcR,IAAS,SAAW,SAAWA,IAAS,WAAa,SAAWA,EAC9ES,EAAWR,EAAS,OAAS,MAC7BS,EAAYT,EAAS,OAAS,OAEpC,KAAK,OAAO,UAAY;AAAA,qBACX,KAAK,WAAW;AAAA,sFACiDF,CAAM,GAAGC,CAAI,cAAcF,CAAM,GAAGE,CAAI;AAAA;AAAA;AAAA,4CAGlFG,CAAS,kBAAkBD,CAAU;AAAA;AAAA;AAAA,wBAGzDO,CAAQ;AAAA,mDACmBF,CAAa,IAAIC,CAAW;AAAA,wBACvDE,CAAS;AAAA;AAAA,SAG7B,CACJ,CAEA,eAAe,OAAO,wBAAyBrB,CAAgB"}