{"version":3,"file":"RacePredictorView-BLkpQYmR.js","sources":["../../src/calculations/racePredictor.ts","../../src/views/RacePredictorView.ts"],"sourcesContent":["/**\n * Race Time Predictor\n *\n * Calculates race time predictions and training paces using multiple formulas:\n * - Jack Daniels' VDOT tables (most comprehensive for runners)\n * - Riegel Formula (simple power law)\n * - Cameron Formula (conservative for marathons)\n * - Pete Riegel's updated formula\n *\n * @module calculations/racePredictor\n */\n\n/**\n * Standard race distances in meters\n */\nexport const RACE_DISTANCES = {\n    '800m': 800,\n    '1500m': 1500,\n    '1 Mile': 1609.34,\n    '3000m': 3000,\n    '5K': 5000,\n    '10K': 10000,\n    'Half Marathon': 21097.5,\n    Marathon: 42195,\n    '50K': 50000,\n    '100K': 100000,\n} as const;\n\nexport type RaceDistance = keyof typeof RACE_DISTANCES;\n\n/**\n * Training pace zones based on VDOT (Jack Daniels)\n */\nexport interface TrainingPaces {\n    easy: number; // seconds per km\n    marathon: number;\n    threshold: number;\n    interval: number;\n    repetition: number;\n}\n\n/**\n * Race prediction result\n */\nexport interface RacePrediction {\n    distance: RaceDistance;\n    distanceMeters: number;\n    timeSeconds: number;\n    timeFormatted: string;\n    pacePerKm: string;\n    pacePerMile: string;\n}\n\n/**\n * VDOT calculation result\n */\nexport interface VDOTResult {\n    vdot: number;\n    vo2max: number; // Estimated VO2max\n}\n\n// ============================================================================\n// VDOT Calculation (Jack Daniels)\n// ============================================================================\n\n/**\n * Calculate VDOT from race performance\n *\n * VDOT is Jack Daniels' running fitness metric based on VO2max and running economy.\n * Formula derived from oxygen cost at different speeds:\n * - VO2 = -4.60 + 0.182258 √ó velocity + 0.000104 √ó velocity¬≤\n * - Percent = 0.8 + 0.1894393 √ó e^(-0.012778 √ó time_minutes) + 0.2989558 √ó e^(-0.1932605 √ó time_minutes)\n * - VDOT = VO2 / Percent\n *\n * @param distanceMeters - Race distance in meters\n * @param timeSeconds - Race time in seconds\n * @returns VDOT value and estimated VO2max\n */\nexport function calculateVDOT(distanceMeters: number, timeSeconds: number): VDOTResult {\n    const velocityMPS = distanceMeters / timeSeconds; // meters per second\n    const velocityMPM = velocityMPS * 60; // meters per minute\n    const timeMinutes = timeSeconds / 60;\n\n    // Calculate oxygen cost (ml/kg/min) - Jack Daniels formula\n    const vo2 = -4.6 + 0.182258 * velocityMPM + 0.000104 * velocityMPM * velocityMPM;\n\n    // Calculate percent of VO2max that can be sustained\n    // This formula estimates what % of VO2max you can maintain for a given duration\n    const percent =\n        0.8 + 0.1894393 * Math.exp(-0.012778 * timeMinutes) + 0.2989558 * Math.exp(-0.1932605 * timeMinutes);\n\n    // VDOT is the VO2max that would be required to run at this pace\n    // Dividing the actual VO2 by the sustainable percent gives us the full VO2max\n    const vdot = vo2 / percent;\n\n    return {\n        vdot: Math.round(vdot * 10) / 10,\n        vo2max: Math.round(vdot * 10) / 10, // VDOT approximates VO2max\n    };\n}\n\n// ============================================================================\n// Training Paces (Jack Daniels)\n// ============================================================================\n\n/**\n * Calculate training paces from VDOT\n *\n * Jack Daniels' training pace zones:\n * - Easy: 59-74% of VDOT velocity (recovery and long runs)\n * - Marathon: ~80-85% of VDOT velocity (marathon pace)\n * - Threshold: 83-88% of VDOT velocity (lactate threshold, tempo runs)\n * - Interval: 95-100% of VDOT velocity (VO2max intervals)\n * - Repetition: 105-120% of VDOT velocity (speed and form)\n *\n * @param vdot - VDOT value\n * @returns Training paces in seconds per km\n */\nexport function calculateTrainingPaces(vdot: number): TrainingPaces {\n    // Calculate velocity at VDOT in m/min (derived from oxygen cost formula)\n    // This is an inverse calculation - simplified approximation\n    const vdotVelocityMPM = (vdot + 4.6 - Math.sqrt((vdot + 4.6) ** 2 - 4 * 0.000104 * vdot)) / (2 * 0.000104);\n\n    const vdotVelocityMPS = vdotVelocityMPM / 60;\n    const vdotPaceSecPerKm = 1000 / vdotVelocityMPS;\n\n    return {\n        easy: Math.round(vdotPaceSecPerKm * 1.35), // ~74% of VDOT velocity\n        marathon: Math.round(vdotPaceSecPerKm * 1.2), // ~83% of VDOT velocity\n        threshold: Math.round(vdotPaceSecPerKm * 1.15), // ~87% of VDOT velocity\n        interval: Math.round(vdotPaceSecPerKm * 1.0), // ~100% of VDOT velocity\n        repetition: Math.round(vdotPaceSecPerKm * 0.9), // ~111% of VDOT velocity\n    };\n}\n\n// ============================================================================\n// Riegel Formula (Power Law)\n// ============================================================================\n\n/**\n * Predict race time using Riegel's formula\n *\n * T2 = T1 √ó (D2 / D1)^1.06\n *\n * Where:\n * - T1 = known race time\n * - D1 = known race distance\n * - T2 = predicted race time\n * - D2 = target race distance\n * - 1.06 = fatigue factor (empirically derived)\n *\n * This is a simple power law that assumes performance degrades with distance.\n * Works well for distances between 5K and Marathon.\n * Less accurate for very short (<800m) or ultra distances (>50K).\n *\n * @param knownDistanceMeters - Distance of known race\n * @param knownTimeSeconds - Time of known race\n * @param targetDistanceMeters - Distance to predict\n * @returns Predicted time in seconds\n */\nexport function predictTimeRiegel(\n    knownDistanceMeters: number,\n    knownTimeSeconds: number,\n    targetDistanceMeters: number\n): number {\n    const ratio = targetDistanceMeters / knownDistanceMeters;\n    return knownTimeSeconds * Math.pow(ratio, 1.06);\n}\n\n// ============================================================================\n// Cameron Formula (Conservative for Marathon)\n// ============================================================================\n\n/**\n * Predict marathon time using Cameron's formula\n *\n * Marathon Time = Half Marathon Time √ó 2.11 (for most runners)\n * Marathon Time = 10K Time √ó 4.66 (alternative)\n *\n * This is more conservative than Riegel for the marathon distance,\n * accounting for the difficulty of maintaining pace over 42K.\n * Based on analysis of thousands of race results.\n *\n * @param knownDistanceMeters - Distance of known race (10K or Half Marathon)\n * @param knownTimeSeconds - Time of known race\n * @returns Predicted marathon time in seconds, or null if distance not supported\n */\nexport function predictMarathonCameron(knownDistanceMeters: number, knownTimeSeconds: number): number | null {\n    const halfMarathonMeters = RACE_DISTANCES['Half Marathon'];\n    const tenKMeters = RACE_DISTANCES['10K'];\n\n    if (Math.abs(knownDistanceMeters - halfMarathonMeters) < 100) {\n        // Half Marathon to Marathon\n        return knownTimeSeconds * 2.11;\n    } else if (Math.abs(knownDistanceMeters - tenKMeters) < 100) {\n        // 10K to Marathon\n        return knownTimeSeconds * 4.66;\n    }\n\n    return null;\n}\n\n// ============================================================================\n// VDOT-Based Predictions (Jack Daniels)\n// ============================================================================\n\n/**\n * Predict race time using VDOT method\n *\n * This is the most comprehensive method:\n * 1. Calculate VDOT from known race\n * 2. Use VDOT to calculate velocity for target distance\n * 3. Account for percentage of VO2max sustainable at that distance\n *\n * Most accurate for trained runners, especially for standard distances.\n *\n * @param vdot - VDOT value\n * @param targetDistanceMeters - Distance to predict\n * @returns Predicted time in seconds\n */\nexport function predictTimeVDOT(vdot: number, targetDistanceMeters: number): number {\n    const targetTimeMinutes = targetDistanceMeters / 1000; // rough estimate for percent calc\n\n    // Calculate sustainable percent of VO2max for this distance\n    const percent =\n        0.8 +\n        0.1894393 * Math.exp(-0.012778 * targetTimeMinutes) +\n        0.2989558 * Math.exp(-0.1932605 * targetTimeMinutes);\n\n    // Calculate oxygen cost we can sustain\n    const vo2 = vdot * percent;\n\n    // Solve for velocity that produces this oxygen cost\n    // vo2 = -4.6 + 0.182258 √ó v + 0.000104 √ó v¬≤\n    // Rearrange: 0.000104v¬≤ + 0.182258v + (-4.6 - vo2) = 0\n    const a = 0.000104;\n    const b = 0.182258;\n    const c = -4.6 - vo2;\n    const velocityMPM = (-b + Math.sqrt(b * b - 4 * a * c)) / (2 * a);\n    const velocityMPS = velocityMPM / 60;\n\n    return targetDistanceMeters / velocityMPS;\n}\n\n// ============================================================================\n// Multi-Formula Predictions\n// ============================================================================\n\n/**\n * Prediction formula type\n */\nexport type PredictionFormula = 'vdot' | 'riegel' | 'cameron';\n\n/**\n * Predict race times for all standard distances using specified formula\n *\n * @param knownDistance - Known race distance\n * @param knownTimeSeconds - Known race time\n * @param formula - Prediction formula to use\n * @returns Array of race predictions\n */\nexport function predictAllRaces(\n    knownDistance: RaceDistance,\n    knownTimeSeconds: number,\n    formula: PredictionFormula = 'vdot'\n): RacePrediction[] {\n    const knownDistanceMeters = RACE_DISTANCES[knownDistance];\n    const vdot = formula === 'vdot' ? calculateVDOT(knownDistanceMeters, knownTimeSeconds).vdot : 0;\n\n    const predictions: RacePrediction[] = [];\n\n    for (const [distanceName, distanceMeters] of Object.entries(RACE_DISTANCES)) {\n        let predictedSeconds: number;\n\n        if (formula === 'vdot') {\n            predictedSeconds = predictTimeVDOT(vdot, distanceMeters);\n        } else if (formula === 'riegel') {\n            predictedSeconds = predictTimeRiegel(knownDistanceMeters, knownTimeSeconds, distanceMeters);\n        } else {\n            // Cameron - only for marathon from 10K/Half\n            if (distanceName === 'Marathon') {\n                const cameronTime = predictMarathonCameron(knownDistanceMeters, knownTimeSeconds);\n                predictedSeconds =\n                    cameronTime || predictTimeRiegel(knownDistanceMeters, knownTimeSeconds, distanceMeters);\n            } else {\n                predictedSeconds = predictTimeRiegel(knownDistanceMeters, knownTimeSeconds, distanceMeters);\n            }\n        }\n\n        predictions.push({\n            distance: distanceName as RaceDistance,\n            distanceMeters,\n            timeSeconds: predictedSeconds,\n            timeFormatted: formatTime(predictedSeconds),\n            pacePerKm: formatPace(predictedSeconds / (distanceMeters / 1000)),\n            pacePerMile: formatPace((predictedSeconds / (distanceMeters / 1000)) * 1.60934),\n        });\n    }\n\n    return predictions;\n}\n\n// ============================================================================\n// Formatting Helpers\n// ============================================================================\n\n/**\n * Format time in seconds to HH:MM:SS or MM:SS\n */\nexport function formatTime(seconds: number): string {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = Math.floor(seconds % 60);\n\n    if (hours > 0) {\n        return `${hours}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;\n    }\n    return `${minutes}:${String(secs).padStart(2, '0')}`;\n}\n\n/**\n * Format pace in seconds to M:SS\n */\nexport function formatPace(secondsPerUnit: number): string {\n    const minutes = Math.floor(secondsPerUnit / 60);\n    const seconds = Math.floor(secondsPerUnit % 60);\n    return `${minutes}:${String(seconds).padStart(2, '0')}`;\n}\n\n/**\n * Parse time string (HH:MM:SS or MM:SS) to seconds\n */\nexport function parseTimeToSeconds(timeString: string): number | null {\n    const parts = timeString.split(':').map((p) => parseInt(p, 10));\n    if (parts.some(isNaN)) return null;\n\n    if (parts.length === 3) {\n        // HH:MM:SS\n        return parts[0] * 3600 + parts[1] * 60 + parts[2];\n    } else if (parts.length === 2) {\n        // MM:SS\n        return parts[0] * 60 + parts[1];\n    }\n\n    return null;\n}\n\n/**\n * Get formula explanation\n */\nexport function getFormulaExplanation(formula: PredictionFormula): string {\n    switch (formula) {\n        case 'vdot':\n            return `**Jack Daniels' VDOT Method** - The most comprehensive approach. Calculates your VDOT (VO2max + running economy) from your race performance, then predicts times based on sustainable percentages of VO2max for each distance. Most accurate for trained runners at standard distances.`;\n        case 'riegel':\n            return `**Riegel Formula** - A simple power law: T2 = T1 √ó (D2/D1)^1.06. Assumes performance degrades with distance at a constant rate. Works well for distances between 5K and Marathon, but less accurate for very short or ultra distances.`;\n        case 'cameron':\n            return `**Cameron Formula** - More conservative for marathon predictions. Uses empirical ratios from thousands of race results: Marathon = Half Marathon √ó 2.11. Accounts for the difficulty of maintaining pace over 42K.`;\n    }\n}\n","/**\n * Race Time Predictor View\n *\n * UI for calculating race time predictions and training paces\n * based on recent race performances.\n *\n * @module views/RacePredictorView\n */\n\nimport type {\n    VDOTResult,\n    RacePrediction,\n    TrainingPaces,\n    RaceDistance,\n    PredictionFormula,\n} from '../calculations/racePredictor.js';\nimport {\n    RACE_DISTANCES,\n    calculateVDOT,\n    calculateTrainingPaces,\n    predictAllRaces,\n    parseTimeToSeconds,\n    formatPace,\n    getFormulaExplanation,\n} from '../calculations/racePredictor.js';\nimport { View } from '../router/View.js';\nimport { ViewId } from '../router/view-ids.js';\n\n/**\n * Race Predictor View Component\n */\nexport class RacePredictorView implements View {\n    public id = ViewId.RacePredictor;\n    private container: HTMLElement | null = null;\n    private currentVDOT: VDOTResult | null = null;\n    private currentPredictions: RacePrediction[] | null = null;\n    private currentTrainingPaces: TrainingPaces | null = null;\n    private currentFormula: PredictionFormula = 'vdot';\n\n    public init(container: HTMLElement): void {\n        this.container = container;\n        this.render();\n    }\n\n    public onEnter(): void {\n        console.log('Entered Race Predictor View');\n        this.render();\n    }\n\n    public onLeave(): void {\n        console.log('Left Race Predictor View');\n    }\n\n    /**\n     * Render the race predictor UI\n     */\n    private render(): void {\n        if (!this.container) return;\n        this.container.innerHTML = `\n            <div class=\"race-predictor-view\">\n                <header class=\"race-predictor-header\">\n                    <h1>üèÅ Race Time Predictor</h1>\n                    <p class=\"subtitle\">Predict race times and calculate training paces from your recent performances</p>\n                </header>\n\n                <section class=\"input-section\">\n                    <h2>Enter Recent Race Performance</h2>\n                    \n                    <div class=\"input-group\">\n                        <label for=\"race-distance\">Race Distance</label>\n                        <select id=\"race-distance\" class=\"input-field\">\n                            ${Object.keys(RACE_DISTANCES)\n                                .map((distance) => `<option value=\"${distance}\">${distance}</option>`)\n                                .join('')}\n                        </select>\n                    </div>\n\n                    <div class=\"input-group\">\n                        <label for=\"race-time\">Race Time (MM:SS or HH:MM:SS)</label>\n                        <input \n                            type=\"text\" \n                            id=\"race-time\" \n                            class=\"input-field\" \n                            placeholder=\"25:30 or 1:45:30\"\n                            pattern=\"[0-9]{1,2}:[0-9]{2}(:[0-9]{2})?\"\n                        />\n                    </div>\n\n                    <div class=\"input-group\">\n                        <label for=\"prediction-formula\">Prediction Formula</label>\n                        <select id=\"prediction-formula\" class=\"input-field\">\n                            <option value=\"vdot\" selected>VDOT (Jack Daniels) - Most Accurate</option>\n                            <option value=\"riegel\">Riegel - Simple Power Law</option>\n                            <option value=\"cameron\">Cameron - Conservative Marathon</option>\n                        </select>\n                    </div>\n\n                    <button id=\"calculate-btn\" class=\"btn btn-primary\">Calculate Predictions</button>\n\n                    <div id=\"formula-explanation\" class=\"formula-explanation\"></div>\n                </section>\n\n                <section id=\"results-section\" class=\"results-section\" style=\"display: none;\">\n                    <div id=\"vdot-results\" class=\"results-card\"></div>\n                    <div id=\"race-predictions\" class=\"results-card\"></div>\n                    <div id=\"training-paces\" class=\"results-card\"></div>\n                </section>\n\n                <section class=\"info-section\">\n                    <h2>About the Formulas</h2>\n                    \n                    <details>\n                        <summary><strong>Jack Daniels' VDOT Method</strong></summary>\n                        <p>VDOT combines VO2max with running economy to create a single fitness metric. The calculation:</p>\n                        <ol>\n                            <li>Calculates oxygen cost at your race pace</li>\n                            <li>Determines the percentage of VO2max you sustained</li>\n                            <li>Derives your VDOT value</li>\n                            <li>Predicts other race times based on sustainable VO2max percentages</li>\n                        </ol>\n                        <p><strong>Best for:</strong> Trained runners at standard distances (800m - Marathon)</p>\n                    </details>\n\n                    <details>\n                        <summary><strong>Riegel Formula</strong></summary>\n                        <p>A simple power law: <code>T2 = T1 √ó (D2/D1)^1.06</code></p>\n                        <p>The 1.06 exponent represents the fatigue factor - how much slower you get as distance increases.</p>\n                        <p><strong>Best for:</strong> Quick estimates between similar distances (5K - Marathon)</p>\n                        <p><strong>Limitations:</strong> Less accurate for very short (<800m) or ultra (>50K) distances</p>\n                    </details>\n\n                    <details>\n                        <summary><strong>Cameron Formula</strong></summary>\n                        <p>Conservative marathon predictions based on empirical data:</p>\n                        <ul>\n                            <li>Marathon = Half Marathon √ó 2.11</li>\n                            <li>Marathon = 10K √ó 4.66</li>\n                        </ul>\n                        <p><strong>Best for:</strong> Marathon predictions from 10K or Half Marathon times</p>\n                        <p><strong>Why conservative:</strong> Accounts for the difficulty of pacing and fueling over 42K</p>\n                    </details>\n\n                    <details>\n                        <summary><strong>Training Pace Zones (VDOT-based)</strong></summary>\n                        <ul>\n                            <li><strong>Easy (E):</strong> 59-74% VDOT velocity - Recovery and long runs</li>\n                            <li><strong>Marathon (M):</strong> 80-85% VDOT velocity - Marathon pace</li>\n                            <li><strong>Threshold (T):</strong> 83-88% VDOT velocity - Lactate threshold, tempo</li>\n                            <li><strong>Interval (I):</strong> 95-100% VDOT velocity - VO2max intervals</li>\n                            <li><strong>Repetition (R):</strong> 105-120% VDOT velocity - Speed and form</li>\n                        </ul>\n                    </details>\n                </section>\n            </div>\n        `;\n\n        this.attachEventListeners();\n        this.updateFormulaExplanation();\n    }\n\n    /**\n     * Attach event listeners\n     */\n    private attachEventListeners(): void {\n        const calculateBtn = document.getElementById('calculate-btn');\n        const raceTimeInput = document.getElementById('race-time') as HTMLInputElement;\n        const formulaSelect = document.getElementById('prediction-formula') as HTMLSelectElement;\n\n        if (calculateBtn) {\n            calculateBtn.addEventListener('click', () => this.handleCalculate());\n        }\n\n        if (raceTimeInput) {\n            raceTimeInput.addEventListener('keypress', (e) => {\n                if (e.key === 'Enter') {\n                    this.handleCalculate();\n                }\n            });\n        }\n\n        if (formulaSelect) {\n            formulaSelect.addEventListener('change', () => {\n                this.currentFormula = formulaSelect.value as PredictionFormula;\n                this.updateFormulaExplanation();\n                // Recalculate if we have data\n                if (this.currentPredictions) {\n                    this.handleCalculate();\n                }\n            });\n        }\n    }\n\n    /**\n     * Update formula explanation text\n     */\n    private updateFormulaExplanation(): void {\n        const explanationDiv = document.getElementById('formula-explanation');\n        if (explanationDiv) {\n            explanationDiv.innerHTML = `<p>${getFormulaExplanation(this.currentFormula)}</p>`;\n        }\n    }\n\n    /**\n     * Handle calculate button click\n     */\n    private handleCalculate(): void {\n        const distanceSelect = document.getElementById('race-distance') as HTMLSelectElement;\n        const timeInput = document.getElementById('race-time') as HTMLInputElement;\n\n        if (!distanceSelect || !timeInput) return;\n\n        const distance = distanceSelect.value as RaceDistance;\n        const timeString = timeInput.value.trim();\n\n        // Parse time\n        const timeSeconds = parseTimeToSeconds(timeString);\n        if (!timeSeconds) {\n            this.showError('Invalid time format. Use MM:SS or HH:MM:SS');\n            return;\n        }\n\n        // Validate time (must be reasonable)\n        const distanceMeters = RACE_DISTANCES[distance];\n        const pacePerKm = timeSeconds / (distanceMeters / 1000);\n        if (pacePerKm < 120) {\n            // Faster than 2:00/km\n            this.showError('Time seems too fast. Please check your input.');\n            return;\n        }\n        if (pacePerKm > 900) {\n            // Slower than 15:00/km\n            this.showError('Time seems too slow. Please check your input.');\n            return;\n        }\n\n        // Calculate VDOT\n        this.currentVDOT = calculateVDOT(distanceMeters, timeSeconds);\n\n        // Calculate training paces (only for VDOT formula)\n        this.currentTrainingPaces =\n            this.currentFormula === 'vdot' ? calculateTrainingPaces(this.currentVDOT.vdot) : null;\n\n        // Predict all races\n        this.currentPredictions = predictAllRaces(distance, timeSeconds, this.currentFormula);\n\n        // Display results\n        this.displayResults();\n    }\n\n    /**\n     * Display calculation results\n     */\n    private displayResults(): void {\n        const resultsSection = document.getElementById('results-section');\n        if (!resultsSection) return;\n\n        resultsSection.style.display = 'block';\n\n        // Display VDOT (only for VDOT formula)\n        if (this.currentFormula === 'vdot' && this.currentVDOT) {\n            this.displayVDOTResults();\n        } else {\n            const vdotDiv = document.getElementById('vdot-results');\n            if (vdotDiv) vdotDiv.innerHTML = '';\n        }\n\n        // Display race predictions\n        this.displayRacePredictions();\n\n        // Display training paces (only for VDOT formula)\n        if (this.currentFormula === 'vdot' && this.currentTrainingPaces) {\n            this.displayTrainingPaces();\n        } else {\n            const pacesDiv = document.getElementById('training-paces');\n            if (pacesDiv) pacesDiv.innerHTML = '';\n        }\n\n        // Scroll to results\n        resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n    }\n\n    /**\n     * Display VDOT results\n     */\n    private displayVDOTResults(): void {\n        const vdotDiv = document.getElementById('vdot-results');\n        if (!vdotDiv || !this.currentVDOT) return;\n\n        vdotDiv.innerHTML = `\n            <h2>Your Running Fitness</h2>\n            <div class=\"vdot-metrics\">\n                <div class=\"metric-card\">\n                    <div class=\"metric-value\">${this.currentVDOT.vdot}</div>\n                    <div class=\"metric-label\">VDOT</div>\n                    <div class=\"metric-description\">Running fitness score</div>\n                </div>\n                <div class=\"metric-card\">\n                    <div class=\"metric-value\">${this.currentVDOT.vo2max}</div>\n                    <div class=\"metric-label\">Est. VO2max</div>\n                    <div class=\"metric-description\">ml/kg/min</div>\n                </div>\n            </div>\n            <p class=\"info-text\">VDOT combines VO2max with running economy. Higher values indicate better fitness.</p>\n        `;\n    }\n\n    /**\n     * Display race predictions\n     */\n    private displayRacePredictions(): void {\n        const predictionsDiv = document.getElementById('race-predictions');\n        if (!predictionsDiv || !this.currentPredictions) return;\n\n        const formulaName =\n            this.currentFormula === 'vdot' ? 'VDOT' : this.currentFormula === 'riegel' ? 'Riegel' : 'Cameron/Riegel';\n\n        predictionsDiv.innerHTML = `\n            <h2>Predicted Race Times (${formulaName})</h2>\n            <div class=\"predictions-table\">\n                <table>\n                    <thead>\n                        <tr>\n                            <th>Distance</th>\n                            <th>Time</th>\n                            <th>Pace/km</th>\n                            <th>Pace/mile</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ${this.currentPredictions\n                            .map(\n                                (pred) => `\n                            <tr>\n                                <td><strong>${pred.distance}</strong></td>\n                                <td>${pred.timeFormatted}</td>\n                                <td>${pred.pacePerKm}</td>\n                                <td>${pred.pacePerMile}</td>\n                            </tr>\n                        `\n                            )\n                            .join('')}\n                    </tbody>\n                </table>\n            </div>\n        `;\n    }\n\n    /**\n     * Display training paces\n     */\n    private displayTrainingPaces(): void {\n        const pacesDiv = document.getElementById('training-paces');\n        if (!pacesDiv || !this.currentTrainingPaces) return;\n\n        pacesDiv.innerHTML = `\n            <h2>Training Pace Zones</h2>\n            <div class=\"training-paces-table\">\n                <table>\n                    <thead>\n                        <tr>\n                            <th>Zone</th>\n                            <th>Purpose</th>\n                            <th>Pace/km</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr class=\"zone-easy\">\n                            <td><strong>Easy (E)</strong></td>\n                            <td>Recovery, long runs</td>\n                            <td>${formatPace(this.currentTrainingPaces.easy)}</td>\n                        </tr>\n                        <tr class=\"zone-marathon\">\n                            <td><strong>Marathon (M)</strong></td>\n                            <td>Marathon pace</td>\n                            <td>${formatPace(this.currentTrainingPaces.marathon)}</td>\n                        </tr>\n                        <tr class=\"zone-threshold\">\n                            <td><strong>Threshold (T)</strong></td>\n                            <td>Tempo runs</td>\n                            <td>${formatPace(this.currentTrainingPaces.threshold)}</td>\n                        </tr>\n                        <tr class=\"zone-interval\">\n                            <td><strong>Interval (I)</strong></td>\n                            <td>VO2max intervals</td>\n                            <td>${formatPace(this.currentTrainingPaces.interval)}</td>\n                        </tr>\n                        <tr class=\"zone-repetition\">\n                            <td><strong>Repetition (R)</strong></td>\n                            <td>Speed work</td>\n                            <td>${formatPace(this.currentTrainingPaces.repetition)}</td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n            <p class=\"info-text\">\n                These paces are calculated from your VDOT and represent optimal training intensities for different workout types.\n            </p>\n        `;\n    }\n\n    /**\n     * Show error message\n     */\n    private showError(message: string): void {\n        const resultsSection = document.getElementById('results-section');\n        if (resultsSection) {\n            resultsSection.style.display = 'block';\n            resultsSection.innerHTML = `\n                <div class=\"error-card\">\n                    <p>‚ùå ${message}</p>\n                </div>\n            `;\n        }\n    }\n\n    /**\n     * Clean up the view\n     */\n    public destroy(): void {\n        if (this.container) {\n            this.container.innerHTML = '';\n        }\n    }\n}\n"],"names":["RACE_DISTANCES","calculateVDOT","distanceMeters","timeSeconds","velocityMPM","timeMinutes","vo2","percent","vdot","calculateTrainingPaces","vdotPaceSecPerKm","predictTimeRiegel","knownDistanceMeters","knownTimeSeconds","targetDistanceMeters","ratio","predictMarathonCameron","halfMarathonMeters","tenKMeters","predictTimeVDOT","targetTimeMinutes","b","c","velocityMPS","predictAllRaces","knownDistance","formula","predictions","distanceName","predictedSeconds","formatTime","formatPace","seconds","hours","minutes","secs","secondsPerUnit","parseTimeToSeconds","timeString","parts","p","getFormulaExplanation","RacePredictorView","ViewId","container","distance","calculateBtn","raceTimeInput","formulaSelect","e","explanationDiv","distanceSelect","timeInput","pacePerKm","resultsSection","vdotDiv","pacesDiv","predictionsDiv","formulaName","pred","message"],"mappings":"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"}