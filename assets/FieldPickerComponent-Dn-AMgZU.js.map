{"version":3,"file":"FieldPickerComponent-Dn-AMgZU.js","sources":["../../src/components/data-fields/FieldPickerComponent.ts"],"sourcesContent":["/**\n * Data Field Picker Web Component\n *\n * Modal dialog for selecting and configuring data fields.\n * Used when adding or editing fields in a data screen.\n *\n * @example\n * ```typescript\n * const picker = document.createElement('bpt-field-picker') as FieldPickerComponent;\n * picker.addEventListener('select', (e) => {\n *   console.log('Selected field:', e.detail.fieldId);\n * });\n * document.body.appendChild(picker);\n * picker.open();\n * ```\n *\n * @module components/data-fields/FieldPickerComponent\n */\n\nimport type { DataFieldDefinition, DataFieldCategory, DataFieldSize } from '../../data-fields/types.js';\nimport { getAllCategories, getFieldsByCategory, searchFields, getDataField } from '../../data-fields/registry.js';\nimport { subscribeToFieldValue } from '../../data-fields/live-values.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface FieldSelectEvent {\n    fieldId: string;\n    field: DataFieldDefinition;\n    size: DataFieldSize;\n}\n\n// ============================================================================\n// Component Definition\n// ============================================================================\n\n/**\n * Data field picker modal component\n */\nexport class FieldPickerComponent extends HTMLElement {\n    private shadow: ShadowRoot;\n    private isOpen = false;\n    private selectedCategory: DataFieldCategory | 'all' = 'all';\n    private searchQuery = '';\n    private selectedFieldId: string | null = null;\n    private selectedSize: DataFieldSize = 'medium';\n    private liveValues: Map<string, string | number | null> = new Map();\n    private activeSubscriptions: (() => void)[] = [];\n\n    // Category icons\n    private static readonly CATEGORY_ICONS: Record<DataFieldCategory | 'all', string> = {\n        all: 'üìä',\n        power: '‚ö°',\n        heartrate: '‚ù§Ô∏è',\n        cadence: 'üîÑ',\n        speed: 'üö¥',\n        distance: 'üìç',\n        elevation: '‚õ∞Ô∏è',\n        time: '‚è±Ô∏è',\n        laps: 'üèÅ',\n        energy: 'üî•',\n        environment: 'üå°Ô∏è',\n        device: 'üîã',\n        charts: 'üìà',\n        map: 'üó∫Ô∏è',\n    };\n\n    // Category display names\n    private static readonly CATEGORY_NAMES: Record<DataFieldCategory | 'all', string> = {\n        all: 'All Fields',\n        power: 'Power',\n        heartrate: 'Heart Rate',\n        cadence: 'Cadence',\n        speed: 'Speed & Pace',\n        distance: 'Distance',\n        elevation: 'Elevation',\n        time: 'Time',\n        laps: 'Laps',\n        energy: 'Energy',\n        environment: 'Environment',\n        device: 'Device',\n        charts: 'Charts',\n        map: 'Map',\n    };\n\n    constructor() {\n        super();\n        this.shadow = this.attachShadow({ mode: 'open' });\n    }\n\n    // ========================================================================\n    // Lifecycle\n    // ========================================================================\n\n    connectedCallback(): void {\n        this.render();\n        this.setupEventListeners();\n    }\n\n    disconnectedCallback(): void {\n        this.removeEventListeners();\n        this.unsubscribeAll();\n    }\n\n    // ========================================================================\n    // Public API\n    // ========================================================================\n\n    /**\n     * Open the picker modal\n     */\n    public open(preselectedFieldId?: string): void {\n        this.isOpen = true;\n        this.selectedFieldId = preselectedFieldId ?? null;\n\n        if (preselectedFieldId) {\n            const field = getDataField(preselectedFieldId);\n            if (field) {\n                this.selectedCategory = field.category;\n                this.selectedSize = field.defaultSize;\n            }\n        }\n\n        this.render();\n        this.updateSubscriptions();\n        this.setAttribute('open', '');\n\n        // Focus search input\n        requestAnimationFrame(() => {\n            const searchInput = this.shadow.querySelector('.picker__search') as HTMLInputElement;\n            searchInput?.focus();\n        });\n    }\n\n    /**\n     * Close the picker modal\n     */\n    public close(): void {\n        this.isOpen = false;\n        this.unsubscribeAll();\n        this.removeAttribute('open');\n        this.render();\n\n        this.dispatchEvent(new CustomEvent('close'));\n    }\n\n    /**\n     * Get whether the picker is currently open\n     */\n    public getIsOpen(): boolean {\n        return this.isOpen;\n    }\n\n    // ========================================================================\n    // Rendering\n    // ========================================================================\n\n    private render(): void {\n        if (!this.isOpen) {\n            this.shadow.innerHTML = `<style>${this.getStyles()}</style>`;\n            return;\n        }\n\n        const fields = this.getFilteredFields();\n        const categories = this.getAvailableCategories();\n\n        this.shadow.innerHTML = `\n            <style>${this.getStyles()}</style>\n            <div class=\"picker__overlay\" data-action=\"close\">\n                <div class=\"picker__dialog\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Select Data Field\">\n                    <header class=\"picker__header\">\n                        <h2 class=\"picker__title\">Select Data Field</h2>\n                        <button class=\"picker__close\" data-action=\"close\" aria-label=\"Close\">√ó</button>\n                    </header>\n                    \n                    <div class=\"picker__search-container\">\n                        <input \n                            type=\"search\" \n                            class=\"picker__search\" \n                            placeholder=\"Search fields...\"\n                            value=\"${this.escapeHtml(this.searchQuery)}\"\n                        >\n                    </div>\n                    \n                    <div class=\"picker__categories\">\n                        ${categories\n                .map(\n                    (cat) => `\n                            <button \n                                class=\"picker__category ${cat === this.selectedCategory ? 'picker__category--active' : ''}\"\n                                data-category=\"${cat}\"\n                            >\n                                <span class=\"picker__category-icon\">${FieldPickerComponent.CATEGORY_ICONS[cat]}</span>\n                                <span class=\"picker__category-name\">${FieldPickerComponent.CATEGORY_NAMES[cat]}</span>\n                            </button>\n                        `\n                )\n                .join('')}\n                    </div>\n                    \n                    <div class=\"picker__fields\">\n                        ${fields.length === 0\n                ? '<p class=\"picker__empty\">No fields found</p>'\n                : fields.map((field) => this.renderFieldOption(field)).join('')\n            }\n                    </div>\n                    \n                    ${this.selectedFieldId ? this.renderSizeSelector() : ''}\n                    \n                    <footer class=\"picker__footer\">\n                        <button class=\"picker__btn picker__btn--cancel\" data-action=\"close\">Cancel</button>\n                        <button \n                            class=\"picker__btn picker__btn--confirm\" \n                            data-action=\"confirm\"\n                            ${!this.selectedFieldId ? 'disabled' : ''}\n                        >\n                            Add Field\n                        </button>\n                    </footer>\n                </div>\n            </div>\n        `;\n    }\n\n    private renderFieldOption(field: DataFieldDefinition): string {\n        const isSelected = field.id === this.selectedFieldId;\n        const liveValue = this.liveValues.get(field.id);\n        const hasValue = liveValue !== undefined && liveValue !== null;\n\n        return `\n            <button \n                class=\"picker__field ${isSelected ? 'picker__field--selected' : ''}\"\n                data-field-id=\"${field.id}\"\n            >\n                <span class=\"picker__field-icon\">${field.icon}</span>\n                <div class=\"picker__field-info\">\n                    <span class=\"picker__field-name\">${this.escapeHtml(field.name)}</span>\n                    <span class=\"picker__field-desc\">${this.escapeHtml(field.description)}</span>\n                </div>\n                ${hasValue\n                ? `<span class=\"picker__field-value\">${liveValue}</span>`\n                : ''\n            }\n                ${field.requiresSensor?.length\n                ? `\n                    <span class=\"picker__field-badge\" title=\"Requires sensor\">üì°</span>\n                `\n                : ''\n            }\n                ${field.requiresWorkoutActive\n                ? `\n                    <span class=\"picker__field-badge\" title=\"Requires active workout\">‚ñ∂Ô∏è</span>\n                `\n                : ''\n            }\n            </button>\n        `;\n    }\n\n    private renderSizeSelector(): string {\n        const field = getDataField(this.selectedFieldId!);\n        if (!field) return '';\n\n        const sizes: DataFieldSize[] = field.supportedSizes;\n\n        return `\n            <div class=\"picker__size-selector\">\n                <label class=\"picker__size-label\">Field Size:</label>\n                <div class=\"picker__sizes\">\n                    ${sizes\n                .map(\n                    (size) => `\n                        <button \n                            class=\"picker__size ${size === this.selectedSize ? 'picker__size--active' : ''}\"\n                            data-size=\"${size}\"\n                        >\n                            ${this.getSizeLabel(size)}\n                        </button>\n                    `\n                )\n                .join('')}\n                </div>\n            </div>\n        `;\n    }\n\n    private getSizeLabel(size: DataFieldSize): string {\n        const labels: Record<DataFieldSize, string> = {\n            small: 'S',\n            medium: 'M',\n            large: 'L',\n            wide: 'W',\n            tall: 'T',\n            full: 'XL',\n        };\n        return labels[size];\n    }\n\n    private getStyles(): string {\n        return `\n            :host {\n                display: contents;\n            }\n            \n            :host(:not([open])) .picker__overlay {\n                display: none;\n            }\n            \n            .picker__overlay {\n                position: fixed;\n                inset: 0;\n                background: rgba(0, 0, 0, 0.6);\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                z-index: 1000;\n                padding: 1rem;\n            }\n            \n            .picker__dialog {\n                background: var(--color-bg, #1a1a2e);\n                border-radius: 12px;\n                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n                width: 100%;\n                max-width: 500px;\n                max-height: 80vh;\n                display: flex;\n                flex-direction: column;\n                overflow: hidden;\n            }\n            \n            .picker__header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                padding: 1rem;\n                border-bottom: 1px solid var(--color-border, #333);\n            }\n            \n            .picker__title {\n                margin: 0;\n                font-size: 1.25rem;\n                font-weight: 600;\n                color: var(--color-text, #fff);\n            }\n            \n            .picker__close {\n                background: none;\n                border: none;\n                color: var(--color-text-secondary, #999);\n                font-size: 1.5rem;\n                cursor: pointer;\n                padding: 0.25rem 0.5rem;\n                line-height: 1;\n                border-radius: 4px;\n            }\n            \n            .picker__close:hover {\n                background: var(--color-bg-hover, #333);\n            }\n            \n            .picker__search-container {\n                padding: 0.75rem 1rem;\n                border-bottom: 1px solid var(--color-border, #333);\n            }\n            \n            .picker__search {\n                width: 100%;\n                padding: 0.5rem 0.75rem;\n                border: 1px solid var(--color-border, #333);\n                border-radius: 6px;\n                background: var(--color-bg-secondary, #252540);\n                color: var(--color-text, #fff);\n                font-size: 0.9rem;\n            }\n            \n            .picker__search::placeholder {\n                color: var(--color-text-secondary, #999);\n            }\n            \n            .picker__categories {\n                display: flex;\n                gap: 0.5rem;\n                padding: 0.75rem 1rem;\n                overflow-x: auto;\n                border-bottom: 1px solid var(--color-border, #333);\n                -webkit-overflow-scrolling: touch;\n            }\n            \n            .picker__category {\n                display: flex;\n                align-items: center;\n                gap: 0.25rem;\n                padding: 0.375rem 0.625rem;\n                border: 1px solid var(--color-border, #333);\n                border-radius: 16px;\n                background: none;\n                color: var(--color-text-secondary, #999);\n                font-size: 0.8rem;\n                cursor: pointer;\n                white-space: nowrap;\n                transition: all 0.2s ease;\n            }\n            \n            .picker__category:hover {\n                border-color: var(--color-primary, #4361ee);\n                color: var(--color-text, #fff);\n            }\n            \n            .picker__category--active {\n                background: var(--color-primary, #4361ee);\n                border-color: var(--color-primary, #4361ee);\n                color: #fff;\n            }\n            \n            .picker__category-icon {\n                font-size: 1rem;\n            }\n            \n            .picker__fields {\n                flex: 1;\n                overflow-y: auto;\n                padding: 0.5rem;\n            }\n            \n            .picker__empty {\n                text-align: center;\n                color: var(--color-text-secondary, #999);\n                padding: 2rem;\n            }\n            \n            .picker__field {\n                display: flex;\n                align-items: center;\n                gap: 0.75rem;\n                width: 100%;\n                padding: 0.75rem;\n                border: 2px solid transparent;\n                border-radius: 8px;\n                background: var(--color-bg-secondary, #252540);\n                color: var(--color-text, #fff);\n                cursor: pointer;\n                text-align: left;\n                margin-bottom: 0.5rem;\n                transition: all 0.2s ease;\n            }\n            \n            .picker__field:hover {\n                border-color: var(--color-primary, #4361ee);\n            }\n            \n            .picker__field--selected {\n                border-color: var(--color-primary, #4361ee);\n                background: rgba(67, 97, 238, 0.1);\n            }\n            \n            .picker__field-icon {\n                font-size: 1.5rem;\n            }\n            \n            .picker__field-info {\n                flex: 1;\n                min-width: 0;\n            }\n            \n            .picker__field-name {\n                display: block;\n                font-weight: 500;\n                margin-bottom: 0.125rem;\n            }\n            \n            .picker__field-desc {\n                display: block;\n                font-size: 0.75rem;\n                color: var(--color-text-secondary, #999);\n                white-space: nowrap;\n                overflow: hidden;\n                text-overflow: ellipsis;\n            }\n\n            .picker__field-value {\n                font-family: monospace;\n                font-size: 0.9rem;\n                color: var(--color-primary, #4361ee);\n                background: rgba(67, 97, 238, 0.1);\n                padding: 0.1rem 0.4rem;\n                border-radius: 4px;\n                margin-right: 0.5rem;\n            }\n            \n            .picker__field-badge {\n                font-size: 0.9rem;\n                opacity: 0.7;\n            }\n            \n            .picker__size-selector {\n                padding: 0.75rem 1rem;\n                border-top: 1px solid var(--color-border, #333);\n                display: flex;\n                align-items: center;\n                gap: 1rem;\n            }\n            \n            .picker__size-label {\n                color: var(--color-text-secondary, #999);\n                font-size: 0.9rem;\n            }\n            \n            .picker__sizes {\n                display: flex;\n                gap: 0.5rem;\n            }\n            \n            .picker__size {\n                width: 2.5rem;\n                height: 2.5rem;\n                border: 2px solid var(--color-border, #333);\n                border-radius: 6px;\n                background: none;\n                color: var(--color-text, #fff);\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.2s ease;\n            }\n            \n            .picker__size:hover {\n                border-color: var(--color-primary, #4361ee);\n            }\n            \n            .picker__size--active {\n                border-color: var(--color-primary, #4361ee);\n                background: var(--color-primary, #4361ee);\n            }\n            \n            .picker__footer {\n                display: flex;\n                justify-content: flex-end;\n                gap: 0.75rem;\n                padding: 1rem;\n                border-top: 1px solid var(--color-border, #333);\n            }\n            \n            .picker__btn {\n                padding: 0.5rem 1rem;\n                border-radius: 6px;\n                font-weight: 500;\n                cursor: pointer;\n                transition: all 0.2s ease;\n            }\n            \n            .picker__btn--cancel {\n                background: none;\n                border: 1px solid var(--color-border, #333);\n                color: var(--color-text, #fff);\n            }\n            \n            .picker__btn--cancel:hover {\n                background: var(--color-bg-hover, #333);\n            }\n            \n            .picker__btn--confirm {\n                background: var(--color-primary, #4361ee);\n                border: none;\n                color: #fff;\n            }\n            \n            .picker__btn--confirm:hover:not(:disabled) {\n                background: var(--color-primary-hover, #3451de);\n            }\n            \n            .picker__btn--confirm:disabled {\n                opacity: 0.5;\n                cursor: not-allowed;\n            }\n        `;\n    }\n\n    // ========================================================================\n    // Event Handling\n    // ========================================================================\n\n    private setupEventListeners(): void {\n        this.shadow.addEventListener('click', this.handleClick.bind(this));\n        this.shadow.addEventListener('input', this.handleInput.bind(this));\n    }\n\n    private removeEventListeners(): void {\n        // Listeners are cleaned up with shadow DOM\n    }\n\n    private handleClick(e: Event): void {\n        const target = e.target as HTMLElement;\n\n        // Check for action buttons\n        const action = target.closest('[data-action]')?.getAttribute('data-action');\n        if (action === 'close') {\n            this.close();\n            return;\n        }\n        if (action === 'confirm') {\n            this.confirmSelection();\n            return;\n        }\n\n        // Check for category selection\n        const categoryBtn = target.closest('[data-category]') as HTMLElement;\n        if (categoryBtn) {\n            this.selectedCategory = categoryBtn.dataset.category as DataFieldCategory | 'all';\n            this.render();\n            if (this.isOpen) {\n                this.updateSubscriptions();\n            }\n            return;\n        }\n\n        // Check for field selection\n        const fieldBtn = target.closest('[data-field-id]') as HTMLElement;\n        if (fieldBtn) {\n            const fieldId = fieldBtn.dataset.fieldId!;\n            this.selectedFieldId = fieldId;\n            const field = getDataField(fieldId);\n            if (field) {\n                this.selectedSize = field.defaultSize;\n            }\n            this.render();\n            return;\n        }\n\n        // Check for size selection\n        const sizeBtn = target.closest('[data-size]') as HTMLElement;\n        if (sizeBtn) {\n            this.selectedSize = sizeBtn.dataset.size as DataFieldSize;\n            this.render();\n            return;\n        }\n    }\n\n    private handleInput(e: Event): void {\n        const target = e.target as HTMLElement;\n\n        if (target.classList.contains('picker__search')) {\n            this.searchQuery = (target as HTMLInputElement).value;\n            this.render();\n            if (this.isOpen) {\n                this.updateSubscriptions();\n            }\n        }\n    }\n\n    private confirmSelection(): void {\n        if (!this.selectedFieldId) return;\n\n        const field = getDataField(this.selectedFieldId);\n        if (!field) return;\n\n        const event = new CustomEvent<FieldSelectEvent>('select', {\n            detail: {\n                fieldId: this.selectedFieldId,\n                field,\n                size: this.selectedSize,\n            },\n        });\n\n        this.dispatchEvent(event);\n        this.close();\n    }\n\n    // ========================================================================\n    // Helper Methods\n    // ========================================================================\n\n    private getFilteredFields(): DataFieldDefinition[] {\n        let fields: DataFieldDefinition[];\n\n        if (this.searchQuery.trim()) {\n            fields = searchFields(this.searchQuery);\n        } else if (this.selectedCategory === 'all') {\n            fields = [];\n            const categories = getAllCategories();\n            for (const [_cat, catFields] of categories) {\n                fields.push(...catFields);\n            }\n        } else {\n            fields = getFieldsByCategory(this.selectedCategory);\n        }\n\n        return fields;\n    }\n\n    private getAvailableCategories(): (DataFieldCategory | 'all')[] {\n        const categories = getAllCategories();\n        const available: (DataFieldCategory | 'all')[] = ['all'];\n\n        for (const cat of categories.keys()) {\n            available.push(cat);\n        }\n\n        return available;\n    }\n\n    private unsubscribeAll(): void {\n        this.activeSubscriptions.forEach((unsub) => unsub());\n        this.activeSubscriptions = [];\n        this.liveValues.clear();\n    }\n\n    private updateSubscriptions(): void {\n        // Unsubscribe from previous set\n        this.unsubscribeAll();\n\n        // Get visible fields based on filters\n        const visibleFields = this.getFilteredFields();\n\n        // Limit subscriptions to avoid performance issues (first 20)\n        const fieldsToSubscribe = visibleFields.slice(0, 20);\n\n        fieldsToSubscribe.forEach((field) => {\n            const unsub = subscribeToFieldValue(field.id, (value) => {\n                let displayValue: string | number | null = value;\n\n                // Simple formatting for display\n                if (typeof value === 'number') {\n                    // Check if it's an integer-like float\n                    if (Number.isInteger(value)) {\n                        displayValue = value;\n                    } else {\n                        // Max 1 decimal for overview\n                        displayValue = value.toFixed(1);\n                    }\n                }\n\n                this.liveValues.set(field.id, displayValue);\n\n                // Update specific element if it exists in DOM\n                const btn = this.shadow.querySelector(`[data-field-id=\"${field.id}\"]`);\n                if (btn) {\n                    let valSpan = btn.querySelector('.picker__field-value');\n                    if (!valSpan && displayValue !== null) {\n                        // Create span if it doesn't exist\n                        valSpan = document.createElement('span');\n                        valSpan.className = 'picker__field-value';\n                        // Insert before badges or at end\n                        const badge = btn.querySelector('.picker__field-badge');\n                        if (badge) {\n                            btn.insertBefore(valSpan, badge);\n                        } else {\n                            btn.appendChild(valSpan);\n                        }\n                    }\n\n                    if (valSpan) {\n                        if (displayValue !== null) {\n                            valSpan.textContent = String(displayValue);\n                        } else {\n                            valSpan.remove();\n                        }\n                    }\n                }\n            });\n            this.activeSubscriptions.push(unsub);\n        });\n    }\n\n    private escapeHtml(str: string): string {\n        const div = document.createElement('div');\n        div.textContent = str;\n        return div.innerHTML;\n    }\n}\n\n// Register the custom element\nif (!customElements.get('bpt-field-picker')) {\n    customElements.define('bpt-field-picker', FieldPickerComponent);\n}\n"],"names":["FieldPickerComponent","preselectedFieldId","field","getDataField","fields","categories","cat","isSelected","liveValue","hasValue","size","target","action","categoryBtn","fieldBtn","fieldId","sizeBtn","event","searchFields","getAllCategories","_cat","catFields","getFieldsByCategory","available","unsub","subscribeToFieldValue","value","displayValue","btn","valSpan","badge","str","div"],"mappings":"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"}