import{C as i,q as o}from"./index-WoRBJzVU.js";import{getClientPMCData as n}from"./fitnessService-h4L75Pmn.js";import"./feature-bluetooth-VMdsGD3M.js";import"./vendor-core-Dob3nYDb.js";import"./feature-export-7zlEGvkQ.js";import"./vendor-leaflet-3-yx3GaH.js";i.register(...o);class m{id="fitness";container=null;chart=null;init(t){this.container=t,this.container.innerHTML=`
            <div class="view-header">
                <h2>Fitness & Freshness</h2>
            </div>
            <div class="fitness-content" style="padding: 1rem;">
                <div class="chart-container" style="position: relative; height: 400px; width: 100%;">
                    <canvas id="pmcChart"></canvas>
                </div>
                <div id="fitness-status" class="status-message" style="margin-top: 1rem; text-align: center; color: var(--text-muted);">Loading data...</div>
            </div>
        `}async onEnter(){await this.loadData()}onLeave(){this.chart&&(this.chart.destroy(),this.chart=null)}async loadData(){try{const t=await n();if(t.length===0){const e=this.container?.querySelector("#fitness-status");e&&(e.textContent="No fitness data available yet. Complete a workout with power data to see your stats!")}this.renderChart(t);const a=this.container?.querySelector("#fitness-status");a&&(a.textContent="")}catch(t){console.error(t);const a=this.container?.querySelector("#fitness-status");a&&(a.textContent="Error loading fitness data.")}}renderChart(t){const a=this.container?.querySelector("#pmcChart")?.getContext("2d");if(!a)return;this.chart&&this.chart.destroy();const e=getComputedStyle(document.body).getPropertyValue("--text-main").trim()||"#ffffff",s=getComputedStyle(document.body).getPropertyValue("--border-color").trim()||"rgba(255, 255, 255, 0.1)";this.chart=new i(a,{type:"line",data:{labels:t.map(r=>r.date),datasets:[{label:"Fitness (CTL)",data:t.map(r=>r.ctl),borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.2)",yAxisID:"y",fill:!0,tension:.1},{label:"Fatigue (ATL)",data:t.map(r=>r.atl),borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.2)",yAxisID:"y",fill:!1,tension:.1},{label:"Form (TSB)",data:t.map(r=>r.tsb),borderColor:"rgb(255, 205, 86)",backgroundColor:r=>r.raw<0?"rgba(255, 99, 132, 0.5)":"rgba(75, 192, 192, 0.5)",yAxisID:"y1",type:"bar",barThickness:"flex",maxBarThickness:10}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{labels:{color:e}}},scales:{x:{ticks:{color:e},grid:{color:s}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Load (TSS/day)",color:e},ticks:{color:e},grid:{color:s}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Form",color:e},grid:{drawOnChartArea:!1},ticks:{color:e}}}}})}}export{m as FitnessView};
//# sourceMappingURL=FitnessView-Ct4tMLnD.js.map
