{"version":3,"file":"PlansView-CCS0yKuU.js","sources":["../../src/plans/library/ftpBuilder.ts","../../src/plans/planRepository.ts","../../src/views/PlansView.ts"],"sourcesContent":["import type { TrainingPlan } from '../types.js';\nimport type { StructuredWorkout } from '../../workouts/types.js';\n\n// Helper to create a simple workout for the plan\nconst createIntervalWorkout = (id: string, name: string, description: string): StructuredWorkout => {\n    return {\n        id,\n        name,\n        description,\n        steps: [\n            { type: 'warmup', duration: 600, target: { type: 'power', unit: 'percent_ftp', value: 50 } },\n            { type: 'active', duration: 300, target: { type: 'power', unit: 'percent_ftp', value: 90 } },\n            { type: 'recovery', duration: 180, target: { type: 'power', unit: 'percent_ftp', value: 50 } },\n            { type: 'active', duration: 300, target: { type: 'power', unit: 'percent_ftp', value: 90 } },\n            { type: 'recovery', duration: 180, target: { type: 'power', unit: 'percent_ftp', value: 50 } },\n            { type: 'active', duration: 300, target: { type: 'power', unit: 'percent_ftp', value: 90 } },\n            { type: 'cooldown', duration: 600, target: { type: 'power', unit: 'percent_ftp', value: 40 } },\n        ],\n    };\n};\n\nconst createEnduranceWorkout = (id: string, name: string): StructuredWorkout => {\n    return {\n        id,\n        name,\n        description: 'Steady zone 2 effort',\n        steps: [\n            { type: 'warmup', duration: 300, target: { type: 'power', unit: 'percent_ftp', value: 50 } },\n            { type: 'active', duration: 1800, target: { type: 'power', unit: 'percent_ftp', value: 65 } }, // 30 min Z2\n            { type: 'cooldown', duration: 300, target: { type: 'power', unit: 'percent_ftp', value: 50 } },\n        ],\n    };\n};\n\nexport const ftpBuilderPlan: TrainingPlan = {\n    id: 'plan-ftp-builder-1',\n    name: '4-Week FTP Booster',\n    description:\n        'A focused 4-week block designed to raise your functional threshold power through sweet spot and threshold intervals.',\n    difficulty: 'intermediate',\n    created: Date.now(),\n    updated: Date.now(),\n    weeks: [\n        {\n            weekNumber: 1,\n            focus: 'Introduction',\n            days: [\n                { dayOfWeek: 1, isRestDay: true, notes: 'Rest day. Stretch.' },\n                {\n                    dayOfWeek: 2,\n                    isRestDay: false,\n                    workout: createIntervalWorkout('ftp-w1-d2', 'Intro Intervals', 'Basic intervals'),\n                },\n                { dayOfWeek: 3, isRestDay: false, workout: createEnduranceWorkout('ftp-w1-d3', 'Aerobic Base') },\n                { dayOfWeek: 4, isRestDay: true },\n                {\n                    dayOfWeek: 5,\n                    isRestDay: false,\n                    workout: createIntervalWorkout('ftp-w1-d5', 'Tempo Work', 'Harder intervals'),\n                },\n                { dayOfWeek: 6, isRestDay: true },\n                { dayOfWeek: 7, isRestDay: false, workout: createEnduranceWorkout('ftp-w1-d7', 'Long Ride') },\n            ],\n        },\n        {\n            weekNumber: 2,\n            focus: 'Build',\n            days: [\n                { dayOfWeek: 1, isRestDay: true },\n                {\n                    dayOfWeek: 2,\n                    isRestDay: false,\n                    workout: createIntervalWorkout('ftp-w2-d2', 'Threshold Push', 'Pushing limits'),\n                },\n                { dayOfWeek: 3, isRestDay: false, workout: createEnduranceWorkout('ftp-w2-d3', 'Recovery Spin') },\n                { dayOfWeek: 4, isRestDay: true },\n                {\n                    dayOfWeek: 5,\n                    isRestDay: false,\n                    workout: createIntervalWorkout('ftp-w2-d5', 'O/U Intervals', 'Over Unders'),\n                },\n                { dayOfWeek: 6, isRestDay: true },\n                { dayOfWeek: 7, isRestDay: false, workout: createEnduranceWorkout('ftp-w2-d7', 'Sunday Long Ride') },\n            ],\n        },\n    ],\n};\n","import type { TrainingPlan } from './types.js';\nimport { ftpBuilderPlan } from './library/ftpBuilder.js';\n\nexport interface PlanProgress {\n    planId: string;\n    startDate: number; // Timestamp\n    completedDays: Record<string, boolean>; // key format: \"week-day\" e.g. \"1-2\" (Week 1, Tuesday)\n}\n\nconst STORAGE_KEY_PLANS = 'bpt-user-plans';\nconst STORAGE_KEY_PROGRESS = 'bpt-plan-progress';\n\nclass PlanRepository {\n    private systemPlans: TrainingPlan[] = [];\n\n    constructor() {\n        this.registerSystemPlan(ftpBuilderPlan);\n    }\n\n    public registerSystemPlan(plan: TrainingPlan) {\n        this.systemPlans.push(plan);\n    }\n\n    public getAllPlans(): TrainingPlan[] {\n        const userPlans = this.getUserPlans();\n        return [...this.systemPlans, ...userPlans];\n    }\n\n    public getPlan(id: string): TrainingPlan | undefined {\n        return this.getAllPlans().find((p) => p.id === id);\n    }\n\n    public getUserPlans(): TrainingPlan[] {\n        try {\n            const raw = localStorage.getItem(STORAGE_KEY_PLANS);\n            return raw ? JSON.parse(raw) : [];\n        } catch (e) {\n            console.error('Failed to load user plans', e);\n            return [];\n        }\n    }\n\n    public saveUserPlan(plan: TrainingPlan): void {\n        const plans = this.getUserPlans();\n        const existingIndex = plans.findIndex((p) => p.id === plan.id);\n\n        if (existingIndex >= 0) {\n            plans[existingIndex] = plan;\n        } else {\n            plans.push(plan);\n        }\n\n        localStorage.setItem(STORAGE_KEY_PLANS, JSON.stringify(plans));\n    }\n\n    public getActiveProgress(): PlanProgress | null {\n        try {\n            const raw = localStorage.getItem(STORAGE_KEY_PROGRESS);\n            return raw ? JSON.parse(raw) : null;\n        } catch {\n            return null;\n        }\n    }\n\n    public startPlan(planId: string, startDate: number = Date.now()): void {\n        const progress: PlanProgress = {\n            planId,\n            startDate,\n            completedDays: {},\n        };\n        localStorage.setItem(STORAGE_KEY_PROGRESS, JSON.stringify(progress));\n    }\n\n    public markDayComplete(week: number, day: number): void {\n        const progress = this.getActiveProgress();\n        if (!progress) return; // No active plan\n\n        const key = `${week}-${day}`;\n        progress.completedDays[key] = true;\n        localStorage.setItem(STORAGE_KEY_PROGRESS, JSON.stringify(progress));\n    }\n\n    public stopActivePlan(): void {\n        localStorage.removeItem(STORAGE_KEY_PROGRESS);\n    }\n}\n\nexport const planRepository = new PlanRepository();\n","import { View } from '../router/View.js';\nimport { ViewId } from '../router/view-ids.js';\nimport { planRepository, type PlanProgress } from '../plans/planRepository.js';\nimport type { TrainingPlan, PlanWeek, PlanDay } from '../plans/types.js';\nimport { formatDuration } from '../api/workoutClient.js';\nimport { startStructuredWorkout } from '../ui/workoutPlayer.js';\nimport { WORKOUT_LIBRARY } from '../workouts/workoutLibrary.js';\nimport { getCustomWorkouts } from '../storage/customWorkouts.js';\nimport type { StructuredWorkout, WorkoutStep } from '../workouts/types.js';\n\nexport class PlansView implements View {\n    public id = ViewId.Plans;\n    private container: HTMLElement | null = null;\n\n    public init(container: HTMLElement): void {\n        this.container = container;\n        this.render();\n    }\n\n    public onEnter(): void {\n        console.log('Entered Plans View');\n        this.render();\n    }\n\n    public onLeave(): void {\n        console.log('Left Plans View');\n    }\n\n    private render(): void {\n        if (!this.container) return;\n\n        // Simple state checking to see if we are viewing details\n        // For now, simpler to just always render dashboard, and handle details via innerHTML replacement\n        // Ideally we would have sub-routes like /plans/:id\n        this.renderDashboard();\n    }\n\n    private renderDashboard() {\n        if (!this.container) return;\n        const activeProgress = planRepository.getActiveProgress();\n        const plans = planRepository.getAllPlans();\n\n        let html = `\n            <div class=\"page-header\" style=\"padding: 16px; border-bottom: 1px solid var(--color-border); display: flex; justify-content: space-between; align-items: center;\">\n                <h2>üìÖ Training Plans</h2>\n            </div>\n            <div class=\"page-content\" style=\"padding: 16px;\">\n        `;\n\n        // Active Plan Section\n        if (activeProgress) {\n            const activePlan = planRepository.getPlan(activeProgress.planId);\n            if (activePlan) {\n                html += this.renderActivePlan(activePlan, activeProgress);\n            }\n        }\n\n        // Available Plans Section\n        html += `\n            <h3>Available Plans</h3>\n            <div class=\"plans-list\" style=\"display: grid; gap: 16px; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\">\n                ${plans.map((plan) => this.renderPlanCard(plan, activeProgress?.planId === plan.id)).join('')}\n            </div>\n        </div>`;\n\n        this.container.innerHTML = html;\n        this.attachListeners(this.container);\n    }\n\n    private renderActivePlan(plan: TrainingPlan, progress: PlanProgress): string {\n        const daysSinceStart = Math.floor((Date.now() - progress.startDate) / (1000 * 60 * 60 * 24));\n        const currentWeekNum = Math.floor(daysSinceStart / 7) + 1;\n        const currentDayNum = (daysSinceStart % 7) + 1;\n\n        return `\n            <div class=\"active-plan-card\" style=\"background: var(--card-bg); padding: 16px; border-radius: 8px; margin-bottom: 24px; border: 2px solid var(--color-primary);\">\n                <div style=\"display: flex; justify-content: space-between; margin-bottom: 12px;\">\n                    <h3 style=\"margin: 0;\">Currently Following: ${plan.name}</h3>\n                    <span class=\"status-badge\" style=\"background: var(--color-primary); color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.8em;\">Active</span>\n                </div>\n                <p><strong>Week ${currentWeekNum}, Day ${currentDayNum}</strong></p>\n                <div style=\"margin-top: 12px;\">\n                    <button class=\"workout-btn btn-stop-plan\" data-id=\"${plan.id}\" style=\"background: var(--color-error); font-size: 0.9em;\">Stop Plan</button>\n                    <button class=\"workout-btn btn-view-plan\" data-id=\"${plan.id}\" style=\"font-size: 0.9em;\">View Schedule</button>\n                </div>\n            </div>\n        `;\n    }\n\n    private renderPlanCard(plan: TrainingPlan, isActive: boolean): string {\n        return `\n            <div class=\"plan-card\" style=\"background: var(--card-bg); padding: 16px; border-radius: 8px; border: 1px solid var(--color-border); ${isActive ? 'opacity: 0.6;' : ''}\">\n                <h4 style=\"margin: 0 0 8px 0;\">${plan.name}</h4>\n                <div style=\"font-size: 0.9em; color: var(--color-text-secondary); margin-bottom: 12px;\">\n                    ${plan.weeks.length} Weeks ‚Ä¢ ${plan.difficulty || 'Intermediate'}\n                </div>\n                <p style=\"font-size: 0.9em; margin-bottom: 16px; line-height: 1.4;\">${plan.description}</p>\n                <button class=\"workout-btn btn-view-plan\" data-id=\"${plan.id}\" style=\"width: 100%;\">View Details</button>\n            </div>\n        `;\n    }\n\n    private renderDetails(planId: string) {\n        if (!this.container) return;\n        const plan = planRepository.getPlan(planId);\n        if (!plan) return;\n\n        const progress = planRepository.getActiveProgress();\n        const isActive = progress?.planId === planId;\n\n        let html = `\n            <div class=\"page-header\" style=\"padding: 16px; border-bottom: 1px solid var(--color-border); display: flex; gap: 8px; align-items: center;\">\n                <button class=\"btn-back-plans\" style=\"background: none; border: none; font-size: 1.2em; cursor: pointer;\">‚Üê</button>\n                <h2 style=\"margin: 0;\">${plan.name}</h2>\n            </div>\n            <div class=\"page-content\" style=\"padding: 16px;\">\n                <p>${plan.description}</p>\n                \n                <div style=\"margin: 16px 0;\">\n                    ${\n                        isActive\n                            ? `<button class=\"workout-btn btn-stop-plan\" data-id=\"${plan.id}\" style=\"background: var(--color-error);\">Stop Plan</button>`\n                            : `<button class=\"workout-btn btn-start-plan\" data-id=\"${plan.id}\" style=\"background: var(--color-success);\">Start Plan</button>`\n                    }\n                </div>\n    \n                <div class=\"plan-weeks\">\n                    ${plan.weeks.map((week) => this.renderWeek(week, isActive ? progress : null)).join('')}\n                </div>\n            </div>\n        `;\n\n        this.container.innerHTML = html;\n        this.attachListeners(this.container, planId);\n    }\n\n    private renderWeek(week: PlanWeek, progress: PlanProgress | null): string {\n        return `\n            <div class=\"plan-week\" style=\"margin-bottom: 20px;\">\n                <h4 style=\"background: var(--bg-secondary); padding: 8px; border-radius: 4px; margin-bottom: 8px;\">\n                    Week ${week.weekNumber}: ${week.focus || ''}\n                </h4>\n                <div class=\"week-days\" style=\"display: grid; gap: 8px;\">\n                    ${week.days.map((day) => this.renderDay(day, week.weekNumber, progress)).join('')}\n                </div>\n            </div>\n        `;\n    }\n\n    private renderDay(day: PlanDay, weekNum: number, progress: PlanProgress | null): string {\n        const isComplete = progress ? progress.completedDays[`${weekNum}-${day.dayOfWeek}`] : false;\n\n        let isToday = false;\n        if (progress) {\n            const daysSinceStart = Math.floor((Date.now() - progress.startDate) / (1000 * 60 * 60 * 24));\n            const currentDayAbsolute = daysSinceStart + 1;\n            const thisDayAbsolute = (weekNum - 1) * 7 + day.dayOfWeek;\n            if (currentDayAbsolute === thisDayAbsolute) isToday = true;\n        }\n\n        let content = '';\n        if (day.isRestDay) {\n            content = `<em>Rest Day</em> ${day.notes ? `- ${day.notes}` : ''}`;\n        } else if (day.workout) {\n            content = `<strong>${day.workout.name}</strong><br><span style=\"font-size: 0.85em; color: var(--color-text-secondary);\">${formatDuration(this.getTotalDuration(day.workout))}</span>`;\n        } else {\n            content = `Workout ID: ${day.workoutId}`;\n        }\n\n        return `\n            <div class=\"plan-day\" style=\"\n                padding: 12px; \n                border: 1px solid var(--color-border); \n                border-radius: 6px; \n                display: flex; \n                align-items: center; \n                gap: 12px;\n                background: ${isToday ? 'var(--bg-highlight, rgba(33, 150, 243, 0.1))' : 'var(--card-bg)'};\n                ${isToday ? 'border-color: var(--color-primary);' : ''}\n            \">\n                <div style=\"\n                    width: 24px; height: 24px; \n                    border-radius: 50%; \n                    background: ${isComplete ? 'var(--color-success)' : '#ccc'}; \n                    color: white;\n                    display: flex; align-items: center; justify-content: center;\n                    font-size: 0.8em;\n                \">${day.dayOfWeek}</div>\n                \n                <div style=\"flex: 1;\">${content}</div>\n    \n                ${\n                    !day.isRestDay && day.workout\n                        ? `\n                    <button class=\"workout-btn btn-preview-workout\" style=\"padding: 4px 8px; font-size: 0.8em;\">Preview</button>\n                    ${progress && !isComplete ? `<button class=\"workout-btn btn-do-workout\" data-week=\"${weekNum}\" data-day=\"${day.dayOfWeek}\" style=\"margin-left:8px; padding: 4px 8px; font-size: 0.8em; background: var(--color-primary);\">Start</button>` : ''}\n                `\n                        : ''\n                }\n            </div>\n        `;\n    }\n\n    private getTotalDuration(workout: StructuredWorkout): number {\n        return workout.steps.reduce((sum: number, step: WorkoutStep) => sum + step.duration, 0);\n    }\n\n    private attachListeners(container: HTMLElement, currentDetailId?: string) {\n        container.onclick = (e) => {\n            const target = e.target as HTMLElement;\n\n            if (target.classList.contains('btn-view-plan')) {\n                const id = target.dataset.id;\n                if (id) this.renderDetails(id);\n            }\n\n            if (target.classList.contains('btn-back-plans')) {\n                this.renderDashboard();\n            }\n\n            if (target.classList.contains('btn-start-plan')) {\n                const id = target.dataset.id;\n                if (id && confirm('Start this training plan? This will become your active plan.')) {\n                    planRepository.startPlan(id);\n                    this.renderDetails(id); // Re-render to show stop button\n                }\n            }\n\n            if (target.classList.contains('btn-stop-plan')) {\n                if (confirm('Are you sure you want to stop the current plan? Progress will be lost.')) {\n                    planRepository.stopActivePlan();\n                    if (currentDetailId) {\n                        this.renderDetails(currentDetailId);\n                    } else {\n                        this.renderDashboard();\n                    }\n                }\n            }\n\n            if (target.classList.contains('btn-do-workout')) {\n                const weekNum = parseInt(target.dataset.week || '0');\n                const dayNum = parseInt(target.dataset.day || '0');\n\n                const progress = planRepository.getActiveProgress();\n                if (!progress) return;\n\n                const plan = planRepository.getPlan(progress.planId);\n                if (!plan) return;\n\n                const week = plan.weeks.find((w) => w.weekNumber === weekNum);\n                const day = week?.days.find((d) => d.dayOfWeek === dayNum);\n\n                if (day) {\n                    let workout: StructuredWorkout | undefined = day.workout;\n\n                    if (!workout && day.workoutId) {\n                        // Resolve ID\n                        workout =\n                            WORKOUT_LIBRARY.find((w) => w.id === day.workoutId) ||\n                            getCustomWorkouts().find((w) => w.id === day.workoutId);\n                    }\n\n                    if (workout) {\n                        startStructuredWorkout(workout, () => {\n                            planRepository.markDayComplete(weekNum, dayNum);\n                            // Refresh view to show progress\n                            this.render();\n                        });\n                    } else {\n                        alert('Workout definition not found!');\n                    }\n                }\n            }\n        };\n    }\n}\n"],"names":["createIntervalWorkout","id","name","description","createEnduranceWorkout","ftpBuilderPlan","STORAGE_KEY_PLANS","STORAGE_KEY_PROGRESS","PlanRepository","plan","userPlans","p","raw","e","plans","existingIndex","planId","startDate","progress","week","day","key","planRepository","PlansView","ViewId","container","activeProgress","html","activePlan","daysSinceStart","currentWeekNum","currentDayNum","isActive","weekNum","isComplete","isToday","currentDayAbsolute","thisDayAbsolute","content","formatDuration","workout","sum","step","currentDetailId","target","dayNum","w","d","WORKOUT_LIBRARY","getCustomWorkouts","startStructuredWorkout"],"mappings":"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"}