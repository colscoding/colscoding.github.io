{"version":3,"mappings":"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","names":["calculatePowerZones7","ftp","calculatePowerZones5","calculatePowerZones3","generatePowerZones","model","ActivitySettingsComponent","settings","getSettings","loadActivityScreens","__vitePreload","err","screens","showPowerSettings","screen","index","e","target","value","key","stored","settingsStore","global","error","updatedSettings","customEvent","activityType","config","newScreen","editedScreen","onSave","fromIndex","toIndex","movedScreen","getDefaultScreensForActivity","saveActivityScreens","event"],"ignoreList":[],"sources":["../../src/utils/zone-utils.ts","../../src/components/data-fields/ActivitySettingsComponent.ts"],"sourcesContent":["import { ZoneDefinition, PowerZoneModel } from '../types/zones.js';\n\n/**\n * Calculate power zones based on FTP (Coggan 7-zone model)\n */\nexport function calculatePowerZones7(ftp: number): ZoneDefinition[] {\n    return [\n        { name: 'Active Recovery', min: 0, max: Math.round(ftp * 0.55), color: '#808080' },\n        { name: 'Endurance', min: Math.round(ftp * 0.55), max: Math.round(ftp * 0.75), color: '#2196f3' },\n        { name: 'Tempo', min: Math.round(ftp * 0.75), max: Math.round(ftp * 0.9), color: '#4caf50' },\n        { name: 'Threshold', min: Math.round(ftp * 0.9), max: Math.round(ftp * 1.05), color: '#ffeb3b' },\n        { name: 'VO2max', min: Math.round(ftp * 1.05), max: Math.round(ftp * 1.2), color: '#ff9800' },\n        { name: 'Anaerobic', min: Math.round(ftp * 1.2), max: Math.round(ftp * 1.5), color: '#f44336' },\n        { name: 'Neuromuscular', min: Math.round(ftp * 1.5), max: 9999, color: '#9c27b0' },\n    ];\n}\n\n/**\n * Calculate power zones based on FTP (5-zone model)\n * Typical Z1-Z5 model\n */\nexport function calculatePowerZones5(ftp: number): ZoneDefinition[] {\n    return [\n        { name: 'Recovery', min: 0, max: Math.round(ftp * 0.6), color: '#808080' },\n        { name: 'Endurance', min: Math.round(ftp * 0.6), max: Math.round(ftp * 0.8), color: '#2196f3' },\n        { name: 'Tempo', min: Math.round(ftp * 0.8), max: Math.round(ftp * 0.95), color: '#4caf50' },\n        { name: 'Threshold', min: Math.round(ftp * 0.95), max: Math.round(ftp * 1.05), color: '#ff9800' },\n        { name: 'VO2max', min: Math.round(ftp * 1.05), max: 9999, color: '#f44336' },\n    ];\n}\n\n/**\n * Calculate power zones based on FTP (3-zone model)\n * Polarized (Zone 1, 2, 3)\n */\nexport function calculatePowerZones3(ftp: number): ZoneDefinition[] {\n    return [\n        { name: 'Endurance', min: 0, max: Math.round(ftp * 0.75), color: '#2196f3' }, // < AeT approx\n        { name: 'Threshold', min: Math.round(ftp * 0.75), max: Math.round(ftp * 1.05), color: '#ff9800' }, // Sweet spot / Threshold\n        { name: 'High Intensity', min: Math.round(ftp * 1.05), max: 9999, color: '#f44336' }, // > FTP\n    ];\n}\n\n/**\n * Calculate heart rate zones based on max HR (5-zone model)\n */\nexport function calculateHrZones(maxHr: number): ZoneDefinition[] {\n    return [\n        { name: 'Recovery', min: Math.round(maxHr * 0.5), max: Math.round(maxHr * 0.6), color: '#808080' },\n        { name: 'Aerobic', min: Math.round(maxHr * 0.6), max: Math.round(maxHr * 0.7), color: '#2196f3' },\n        { name: 'Tempo', min: Math.round(maxHr * 0.7), max: Math.round(maxHr * 0.8), color: '#4caf50' },\n        { name: 'Threshold', min: Math.round(maxHr * 0.8), max: Math.round(maxHr * 0.9), color: '#ff9800' },\n        { name: 'Anaerobic', min: Math.round(maxHr * 0.9), max: maxHr, color: '#f44336' },\n    ];\n}\n\nexport function generatePowerZones(ftp: number, model: PowerZoneModel): ZoneDefinition[] {\n    switch (model) {\n        case '3':\n            return calculatePowerZones3(ftp);\n        case '5':\n            return calculatePowerZones5(ftp);\n        case '7':\n            return calculatePowerZones7(ftp);\n        default:\n            return calculatePowerZones7(ftp);\n    }\n}\n","/**\n * Activity Settings Component\n *\n * Simplified component for managing data screens for each activity type.\n * Replaces the complex ProfileSettingsComponent with direct activity ‚Üí screens mapping.\n *\n * Features:\n * - View screens for current activity type\n * - Add/remove/reorder screens\n * - Edit screen names and icons\n * - Edit field layout per screen\n *\n * @module ActivitySettingsComponent\n */\n\nimport { loadActivityScreens, saveActivityScreens } from '../../data-fields/persistence.js';\nimport { getDefaultScreensForActivity } from '../../data-fields/defaults.js';\nimport type { ActivityScreensConfig, ActivityType, DataScreen } from '../../data-fields/types.js';\nimport { getSettings } from '../../config/settings.js';\nimport type { ScreenEditorModal } from './ScreenEditorModal.js';\nimport { settingsStore } from '../../state/SettingsStore.js';\nimport { generatePowerZones } from '../../utils/zone-utils.js';\nimport type { PowerZoneModel } from '../../types/zones.js';\nimport type { AutoPauseSettings, AutoLapSettings } from '../../config/settings.js';\n\n/**\n * Web Component for managing activity-based screen configurations\n */\nexport class ActivitySettingsComponent extends HTMLElement {\n    private activityType: ActivityType = 'cycling';\n    private screensConfig: ActivityScreensConfig | null = null;\n    private screenEditor: ScreenEditorModal | null = null;\n    public shadowRoot!: ShadowRoot;\n    private boundActivityChangeHandler: ((e: Event) => void) | null = null;\n    private activityFtp: number = 200;\n    private activityPowerZoneModel: PowerZoneModel = '7';\n    private activityAutoPause: AutoPauseSettings = {\n        enabled: false,\n        source: 'speed',\n        threshold: 3,\n        delay: 3,\n    };\n    private activityAutoLap: AutoLapSettings = {\n        enabled: false,\n        source: 'distance',\n        distanceKm: 1,\n        timeMinutes: 5,\n    };\n    private boundClickHandler: ((e: Event) => void) | null = null;\n    private boundInputHandler: ((e: Event) => void) | null = null;\n    private boundChangeHandler: ((e: Event) => void) | null = null;\n\n    constructor() {\n        super();\n        this.shadowRoot = this.attachShadow({ mode: 'open' });\n    }\n\n    public connectedCallback(): void {\n        // Get current activity type from settings\n        const settings = getSettings();\n        this.activityType = settings.sportType || 'cycling';\n\n        // Load screens for this activity\n        this.screensConfig = loadActivityScreens(this.activityType);\n\n        // Load activity-specific FTP and Power Zone Model (fallback to global settings)\n        this.loadActivitySettings();\n\n        // Ensure screen editor is available\n        if (!customElements.get('bpt-screen-editor-modal')) {\n            import('./ScreenEditorModal.js').catch((err) => {\n                console.error('[ActivitySettings] Failed to load screen editor:', err);\n            });\n        }\n\n        // Listen for activity type changes from settings dropdown\n        this.boundActivityChangeHandler = this.handleActivityChange.bind(this);\n        document.addEventListener('data-fields-activity-changed', this.boundActivityChangeHandler);\n\n        // Bind handlers once\n        this.boundClickHandler = this.handleClick.bind(this);\n        this.boundInputHandler = this.handleInput.bind(this);\n        this.boundChangeHandler = this.handleChange.bind(this);\n\n        this.render();\n        // Attach event listeners after initial render\n        this.attachEventListeners();\n    }\n\n    public disconnectedCallback(): void {\n        // Clean up event listeners\n        if (this.boundActivityChangeHandler) {\n            document.removeEventListener('data-fields-activity-changed', this.boundActivityChangeHandler);\n            this.boundActivityChangeHandler = null;\n        }\n\n        // Clean up shadow root listeners\n        if (this.boundClickHandler) {\n            this.shadowRoot.removeEventListener('click', this.boundClickHandler);\n        }\n        if (this.boundInputHandler) {\n            this.shadowRoot.removeEventListener('input', this.boundInputHandler);\n        }\n        if (this.boundChangeHandler) {\n            this.shadowRoot.removeEventListener('change', this.boundChangeHandler);\n        }\n\n        // Clean up screen editor\n        if (this.screenEditor && this.screenEditor.parentElement) {\n            this.screenEditor.remove();\n            this.screenEditor = null;\n        }\n    }\n\n    /**\n     * Render the component UI\n     */\n    private render(): void {\n        if (!this.screensConfig) return;\n\n        const screens = this.screensConfig.screens || [];\n        const showPowerSettings = this.activityType === 'cycling' || this.activityType === 'indoor';\n\n        this.shadowRoot.innerHTML = `\n            <style>\n                :host {\n                    display: block;\n                    padding: 1rem;\n                }\n\n                .activity-header {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    margin-bottom: 1rem;\n                }\n\n                .activity-header h3 {\n                    margin: 0;\n                    font-size: 1.25rem;\n                }\n\n                .settings-section {\n                    border: 1px solid var(--border-color, #ccc);\n                    border-radius: 8px;\n                    padding: 1rem;\n                    margin-bottom: 1rem;\n                    background: var(--card-bg, white);\n                }\n\n                .settings-section h4 {\n                    margin: 0 0 1rem 0;\n                    font-size: 1.1rem;\n                    color: var(--text-primary, #333);\n                }\n\n                .setting-row {\n                    display: flex;\n                    flex-direction: column;\n                    gap: 0.5rem;\n                    margin-bottom: 1rem;\n                }\n\n                .setting-row:last-child {\n                    margin-bottom: 0;\n                }\n\n                .setting-label {\n                    font-size: 0.95rem;\n                    font-weight: 500;\n                    color: var(--text-primary, #333);\n                }\n\n                .setting-input-row {\n                    display: flex;\n                    align-items: center;\n                    gap: 0.5rem;\n                }\n\n                .setting-input {\n                    padding: 0.5rem;\n                    border: 1px solid var(--border-color, #ccc);\n                    border-radius: 4px;\n                    font-size: 0.95rem;\n                    flex: 1;\n                    max-width: 200px;\n                }\n\n                .setting-unit {\n                    font-size: 0.875rem;\n                    color: var(--text-muted, #666);\n                    white-space: nowrap;\n                }\n\n                .setting-description {\n                    font-size: 0.8rem;\n                    color: var(--text-muted, #666);\n                    margin: 0.25rem 0 0 0;\n                }\n\n                .screens-list {\n                    display: flex;\n                    flex-direction: column;\n                    gap: 0.5rem;\n                }\n\n                .screen-item {\n                    border: 1px solid var(--border-color, #ccc);\n                    border-radius: 8px;\n                    padding: 1rem;\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    background: var(--card-bg, white);\n                }\n\n                .screen-info {\n                    display: flex;\n                    align-items: center;\n                    gap: 0.5rem;\n                }\n\n                .screen-icon {\n                    font-size: 1.5rem;\n                }\n\n                .screen-name {\n                    font-weight: 500;\n                }\n\n                .screen-field-count {\n                    color: var(--text-muted, #666);\n                    font-size: 0.875rem;\n                }\n\n                .screen-actions {\n                    display: flex;\n                    gap: 0.5rem;\n                }\n\n                button {\n                    padding: 0.5rem 1rem;\n                    border-radius: 4px;\n                    border: 1px solid var(--border-color, #ccc);\n                    background: var(--button-bg, white);\n                    cursor: pointer;\n                    font-size: 0.875rem;\n                }\n\n                button:hover {\n                    background: var(--button-hover-bg, #f0f0f0);\n                }\n\n                .btn-primary {\n                    background: var(--primary-color, #007bff);\n                    color: white;\n                    border-color: var(--primary-color, #007bff);\n                }\n\n                .btn-primary:hover {\n                    background: var(--primary-hover, #0056b3);\n                }\n\n                .btn-danger {\n                    color: var(--danger-color, #dc3545);\n                }\n\n                .btn-danger:hover {\n                    background: var(--danger-bg, #f8d7da);\n                }\n\n                .empty-state {\n                    text-align: center;\n                    padding: 2rem;\n                    color: var(--text-muted, #666);\n                }\n\n                .reset-section {\n                    margin-top: 2rem;\n                    padding-top: 1rem;\n                    border-top: 1px solid var(--border-color, #ccc);\n                }\n\n                @media (max-width: 768px) {\n                    .screen-item {\n                        flex-direction: column;\n                        align-items: flex-start;\n                        gap: 0.75rem;\n                    }\n\n                    .screen-actions {\n                        width: 100%;\n                        flex-wrap: wrap;\n                    }\n\n                    button {\n                        flex: 1;\n                        min-width: 100px;\n                    }\n\n                    .setting-input {\n                        max-width: 100%;\n                    }\n                }\n            </style>\n\n            <div class=\"activity-header\">\n                <h3>üì± Data Screens for ${this.getActivityDisplayName()}</h3>\n                <button class=\"btn-primary\" id=\"add-screen\">+ Add Screen</button>\n            </div>\n\n            ${showPowerSettings\n                ? `\n                <div class=\"settings-section\">\n                    <h4>‚ö° Power Settings</h4>\n                    <div class=\"setting-row\">\n                        <label class=\"setting-label\" for=\"activity-ftp\">Functional Threshold Power (FTP)</label>\n                        <div class=\"setting-input-row\">\n                            <input\n                                type=\"number\"\n                                id=\"activity-ftp\"\n                                class=\"setting-input\"\n                                min=\"0\"\n                                max=\"2000\"\n                                value=\"${this.activityFtp}\"\n                                placeholder=\"e.g. 200-350\"\n                            />\n                            <span class=\"setting-unit\">Watts</span>\n                        </div>\n                        <p class=\"setting-description\">\n                            Your one-hour maximum sustainable power for ${this.getActivityDisplayName()}. Used for zone calculations.\n                        </p>\n                    </div>\n                    <div class=\"setting-row\">\n                        <label class=\"setting-label\" for=\"activity-power-zone-model\">Power Zone Model</label>\n                        <select id=\"activity-power-zone-model\" class=\"setting-input\" style=\"max-width: 200px;\">\n                            <option value=\"3\" ${this.activityPowerZoneModel === '3' ? 'selected' : ''}>3 Zones (Polarized)</option>\n                            <option value=\"5\" ${this.activityPowerZoneModel === '5' ? 'selected' : ''}>5 Zones (Standard)</option>\n                            <option value=\"7\" ${this.activityPowerZoneModel === '7' ? 'selected' : ''}>7 Zones (Coggan)</option>\n                        </select>\n                        <p class=\"setting-description\">\n                            Choose how power zones are calculated: 3 zones for polarized training, 7 zones for detailed analysis.\n                        </p>\n                    </div>\n                </div>\n            `\n                : ''\n            }\n\n            <div class=\"settings-section\">\n                <h4>‚è∏Ô∏è Auto-Pause</h4>\n                <div class=\"setting-row\">\n                    <label class=\"setting-input-row\" style=\"cursor: pointer;\">\n                        <input\n                            type=\"checkbox\"\n                            id=\"activity-auto-pause-enabled\"\n                            ${this.activityAutoPause.enabled ? 'checked' : ''}\n                            style=\"width: 20px; height: 20px;\"\n                        />\n                        <span class=\"setting-label\">Enable Auto-Pause</span>\n                    </label>\n                    <p class=\"setting-description\">\n                        Automatically pause when activity drops below threshold.\n                    </p>\n                </div>\n                ${this.activityAutoPause.enabled\n                ? `\n                    <div class=\"setting-row\">\n                        <label class=\"setting-label\" for=\"activity-auto-pause-source\">Monitor</label>\n                        <select id=\"activity-auto-pause-source\" class=\"setting-input\" style=\"max-width: 200px;\">\n                            <option value=\"speed\" ${this.activityAutoPause.source === 'speed' ? 'selected' : ''}>Speed</option>\n                            <option value=\"power\" ${this.activityAutoPause.source === 'power' ? 'selected' : ''}>Power</option>\n                            <option value=\"cadence\" ${this.activityAutoPause.source === 'cadence' ? 'selected' : ''}>Cadence</option>\n                        </select>\n                    </div>\n                    <div class=\"setting-row\">\n                        <label class=\"setting-label\" for=\"activity-auto-pause-threshold\">Threshold</label>\n                        <div class=\"setting-input-row\">\n                            <input\n                                type=\"number\"\n                                id=\"activity-auto-pause-threshold\"\n                                class=\"setting-input\"\n                                min=\"0\"\n                                max=\"100\"\n                                step=\"0.5\"\n                                value=\"${this.activityAutoPause.threshold}\"\n                                style=\"max-width: 100px;\"\n                            />\n                            <span class=\"setting-unit\" id=\"auto-pause-unit\">${this.getAutoPauseUnit()}</span>\n                        </div>\n                    </div>\n                    <div class=\"setting-row\">\n                        <label class=\"setting-label\" for=\"activity-auto-pause-delay\">Delay</label>\n                        <div class=\"setting-input-row\">\n                            <input\n                                type=\"number\"\n                                id=\"activity-auto-pause-delay\"\n                                class=\"setting-input\"\n                                min=\"1\"\n                                max=\"30\"\n                                step=\"1\"\n                                value=\"${this.activityAutoPause.delay}\"\n                                style=\"max-width: 100px;\"\n                            />\n                            <span class=\"setting-unit\">seconds</span>\n                        </div>\n                        <p class=\"setting-description\">\n                            Workout will pause after being below threshold for this duration.\n                        </p>\n                    </div>\n                    `\n                : ''\n            }\n            </div>\n\n            <div class=\"settings-section\">\n                <h4>üèÅ Auto-Lap</h4>\n                <div class=\"setting-row\">\n                    <label class=\"setting-input-row\" style=\"cursor: pointer;\">\n                        <input\n                            type=\"checkbox\"\n                            id=\"activity-auto-lap-enabled\"\n                            ${this.activityAutoLap.enabled ? 'checked' : ''}\n                            style=\"width: 20px; height: 20px;\"\n                        />\n                        <span class=\"setting-label\">Enable Auto-Lap</span>\n                    </label>\n                    <p class=\"setting-description\">\n                        Automatically mark laps at intervals.\n                    </p>\n                </div>\n                ${this.activityAutoLap.enabled\n                ? `\n                    <div class=\"setting-row\">\n                        <label class=\"setting-label\" for=\"activity-auto-lap-source\">Trigger</label>\n                        <select id=\"activity-auto-lap-source\" class=\"setting-input\" style=\"max-width: 200px;\">\n                            <option value=\"distance\" ${this.activityAutoLap.source === 'distance' ? 'selected' : ''}>Distance</option>\n                            <option value=\"time\" ${this.activityAutoLap.source === 'time' ? 'selected' : ''}>Time</option>\n                        </select>\n                    </div>\n                    ${this.activityAutoLap.source === 'distance'\n                    ? `\n                        <div class=\"setting-row\">\n                            <label class=\"setting-label\" for=\"activity-auto-lap-distance\">Every</label>\n                            <select id=\"activity-auto-lap-distance\" class=\"setting-input\" style=\"max-width: 200px;\">\n                                <option value=\"0.4\" ${this.activityAutoLap.distanceKm === 0.4 ? 'selected' : ''}>400m</option>\n                                <option value=\"1\" ${this.activityAutoLap.distanceKm === 1 ? 'selected' : ''}>1 km</option>\n                                <option value=\"1.60934\" ${this.activityAutoLap.distanceKm === 1.60934 ? 'selected' : ''}>1 mile</option>\n                                <option value=\"2\" ${this.activityAutoLap.distanceKm === 2 ? 'selected' : ''}>2 km</option>\n                                <option value=\"5\" ${this.activityAutoLap.distanceKm === 5 ? 'selected' : ''}>5 km</option>\n                                <option value=\"10\" ${this.activityAutoLap.distanceKm === 10 ? 'selected' : ''}>10 km</option>\n                            </select>\n                        </div>\n                        `\n                    : `\n                        <div class=\"setting-row\">\n                            <label class=\"setting-label\" for=\"activity-auto-lap-time\">Every</label>\n                            <select id=\"activity-auto-lap-time\" class=\"setting-input\" style=\"max-width: 200px;\">\n                                <option value=\"1\" ${this.activityAutoLap.timeMinutes === 1 ? 'selected' : ''}>1 minute</option>\n                                <option value=\"5\" ${this.activityAutoLap.timeMinutes === 5 ? 'selected' : ''}>5 minutes</option>\n                                <option value=\"10\" ${this.activityAutoLap.timeMinutes === 10 ? 'selected' : ''}>10 minutes</option>\n                                <option value=\"15\" ${this.activityAutoLap.timeMinutes === 15 ? 'selected' : ''}>15 minutes</option>\n                                <option value=\"30\" ${this.activityAutoLap.timeMinutes === 30 ? 'selected' : ''}>30 minutes</option>\n                            </select>\n                        </div>\n                        `\n                }\n                    `\n                : ''\n            }\n            </div>\n\n            ${screens.length === 0\n                ? `\n                <div class=\"empty-state\">\n                    <p>No screens configured for this activity.</p>\n                    <p>Click \"Add Screen\" to create your first screen.</p>\n                </div>\n            `\n                : `\n                <div class=\"screens-list\">\n                    ${screens\n                    .map(\n                        (screen, index) => `\n                        <div class=\"screen-item\" data-index=\"${index}\">\n                            <div class=\"screen-info\">\n                                <span class=\"screen-icon\">${screen.icon || 'üìä'}</span>\n                                <div>\n                                    <div class=\"screen-name\">${screen.name}</div>\n                                    <div class=\"screen-field-count\">\n                                        ${screen.slots.length} fields\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"screen-actions\">\n                                <button class=\"btn-edit\" data-index=\"${index}\">Edit</button>\n                                <button class=\"btn-move-up\" data-index=\"${index}\" ${index === 0 ? 'disabled' : ''\n                            }>‚Üë</button>\n                                <button class=\"btn-move-down\" data-index=\"${index}\" ${index === screens.length - 1 ? 'disabled' : ''\n                            }>‚Üì</button>\n                                <button class=\"btn-danger\" data-index=\"${index}\">Delete</button>\n                            </div>\n                        </div>\n                    `\n                    )\n                    .join('')}\n                </div>\n            `\n            }\n\n            <div class=\"reset-section\">\n                <button id=\"reset-defaults\">Reset to Defaults</button>\n                <small style=\"display: block; margin-top: 0.5rem; color: var(--text-muted, #666);\">\n                    This will restore the default screens for ${this.getActivityDisplayName()}.\n                </small>\n            </div>\n        `;\n    }\n\n    /**\n     * Attach event listeners to buttons\n     */\n    private attachEventListeners(): void {\n        // Remove old listeners first to prevent duplicates\n        if (this.boundClickHandler) {\n            this.shadowRoot.removeEventListener('click', this.boundClickHandler);\n        }\n        if (this.boundInputHandler) {\n            this.shadowRoot.removeEventListener('input', this.boundInputHandler);\n        }\n        if (this.boundChangeHandler) {\n            this.shadowRoot.removeEventListener('change', this.boundChangeHandler);\n        }\n\n        // Use event delegation for better performance\n        if (this.boundClickHandler) {\n            this.shadowRoot.addEventListener('click', this.boundClickHandler);\n        }\n        if (this.boundInputHandler) {\n            this.shadowRoot.addEventListener('input', this.boundInputHandler);\n        }\n        if (this.boundChangeHandler) {\n            this.shadowRoot.addEventListener('change', this.boundChangeHandler);\n        }\n    }\n\n    /**\n     * Handle input changes for activity settings\n     */\n    private handleInput(e: Event): void {\n        const target = e.target as HTMLInputElement | HTMLSelectElement;\n\n        if (target.id === 'activity-ftp') {\n            const value = parseInt(target.value, 10);\n            if (!isNaN(value) && value >= 0) {\n                this.activityFtp = value;\n                this.saveActivitySettings();\n            }\n        } else if (target.id === 'activity-auto-pause-threshold') {\n            const value = parseFloat(target.value);\n            if (!isNaN(value) && value >= 0) {\n                this.activityAutoPause.threshold = value;\n                this.saveActivitySettings();\n            }\n        } else if (target.id === 'activity-auto-pause-delay') {\n            const value = parseInt(target.value, 10);\n            if (!isNaN(value) && value >= 1) {\n                this.activityAutoPause.delay = value;\n                this.saveActivitySettings();\n            }\n        }\n    }\n\n    /**\n     * Handle change events (e.g., select dropdowns and checkboxes)\n     */\n    private handleChange(e: Event): void {\n        const target = e.target as HTMLSelectElement | HTMLInputElement;\n\n        if (target.id === 'activity-power-zone-model') {\n            const value = target.value as PowerZoneModel;\n            if (value === '3' || value === '5' || value === '7') {\n                this.activityPowerZoneModel = value;\n                this.saveActivitySettings();\n            }\n        } else if (target.id === 'activity-auto-pause-enabled') {\n            this.activityAutoPause.enabled = (target as HTMLInputElement).checked;\n            this.saveActivitySettings();\n            this.render();\n            this.attachEventListeners();\n        } else if (target.id === 'activity-auto-pause-source') {\n            this.activityAutoPause.source = target.value as 'speed' | 'power' | 'cadence';\n            this.saveActivitySettings();\n            this.render();\n            this.attachEventListeners();\n        } else if (target.id === 'activity-auto-lap-enabled') {\n            this.activityAutoLap.enabled = (target as HTMLInputElement).checked;\n            this.saveActivitySettings();\n            this.render();\n            this.attachEventListeners();\n        } else if (target.id === 'activity-auto-lap-source') {\n            this.activityAutoLap.source = target.value as 'distance' | 'time';\n            this.saveActivitySettings();\n            this.render();\n            this.attachEventListeners();\n        } else if (target.id === 'activity-auto-lap-distance') {\n            this.activityAutoLap.distanceKm = parseFloat(target.value);\n            this.saveActivitySettings();\n        } else if (target.id === 'activity-auto-lap-time') {\n            this.activityAutoLap.timeMinutes = parseInt(target.value, 10);\n            this.saveActivitySettings();\n        }\n    }\n\n    /**\n     * Load activity-specific settings from localStorage\n     */\n    private loadActivitySettings(): void {\n        try {\n            const key = `bpt-activity-settings-${this.activityType}`;\n            const stored = localStorage.getItem(key);\n\n            if (stored) {\n                const settings = JSON.parse(stored) as {\n                    ftp?: number;\n                    powerZoneModel?: PowerZoneModel;\n                    autoPause?: AutoPauseSettings;\n                    autoLap?: AutoLapSettings;\n                };\n                this.activityFtp = settings.ftp ?? settingsStore.getAll().ftp;\n                this.activityPowerZoneModel = settings.powerZoneModel ?? settingsStore.getAll().powerZoneModel;\n\n                // Load auto-pause settings (fallback to defaults)\n                this.activityAutoPause = settings.autoPause ?? {\n                    enabled: false,\n                    source: 'speed',\n                    threshold: 3,\n                    delay: 3,\n                };\n\n                // Load auto-lap settings (fallback to global settings)\n                this.activityAutoLap = settings.autoLap ?? {\n                    enabled: false,\n                    source: 'distance',\n                    distanceKm: 1,\n                    timeMinutes: 5,\n                };\n            } else {\n                // Fallback to global settings\n                const global = settingsStore.getAll();\n                this.activityFtp = global.ftp;\n                this.activityPowerZoneModel = global.powerZoneModel;\n                this.activityAutoPause = {\n                    enabled: false,\n                    source: 'speed',\n                    threshold: 3,\n                    delay: 3,\n                };\n                this.activityAutoLap = {\n                    enabled: false,\n                    source: 'distance',\n                    distanceKm: 1,\n                    timeMinutes: 5,\n                };\n            }\n        } catch (error) {\n            console.error('[ActivitySettings] Failed to load activity settings:', error);\n            // Fallback to global settings\n            const global = settingsStore.getAll();\n            this.activityFtp = global.ftp;\n            this.activityPowerZoneModel = global.powerZoneModel;\n            this.activityAutoPause = {\n                enabled: false,\n                source: 'speed',\n                threshold: 3,\n                delay: 3,\n            };\n            this.activityAutoLap = {\n                enabled: false,\n                source: 'distance',\n                distanceKm: 1,\n                timeMinutes: 5,\n            };\n        }\n    }\n\n    /**\n     * Save activity-specific settings to localStorage and update global settings\n     */\n    private saveActivitySettings(): void {\n        try {\n            // Save to activity-specific storage\n            const key = `bpt-activity-settings-${this.activityType}`;\n            const settings = {\n                ftp: this.activityFtp,\n                powerZoneModel: this.activityPowerZoneModel,\n                autoPause: this.activityAutoPause,\n                autoLap: this.activityAutoLap,\n            };\n            localStorage.setItem(key, JSON.stringify(settings));\n\n            // Update global SettingsStore (for current session compatibility)\n            void settingsStore.setMultiple({\n                ftp: this.activityFtp,\n                powerZoneModel: this.activityPowerZoneModel,\n                powerZones: generatePowerZones(this.activityFtp, this.activityPowerZoneModel),\n            });\n\n            // Update global settings for auto-pause and auto-lap\n            const currentGlobalSettings = getSettings();\n            const updatedSettings = {\n                ...currentGlobalSettings,\n                autoPause: this.activityAutoPause,\n                autoLap: this.activityAutoLap,\n            };\n            localStorage.setItem('bpt-settings', JSON.stringify(updatedSettings));\n\n            console.log(`[ActivitySettings] Saved settings for ${this.activityType}:`, settings);\n\n            // Dispatch event to notify other components\n            window.dispatchEvent(new CustomEvent('user-profile-changed'));\n        } catch (error) {\n            console.error('[ActivitySettings] Failed to save activity settings:', error);\n        }\n    }\n\n    /**\n     * Handle all clicks using event delegation\n     */\n    private handleClick(e: Event): void {\n        const target = e.target as HTMLElement;\n\n        // Add screen button\n        if (target.id === 'add-screen') {\n            this.handleAddScreen();\n            return;\n        }\n\n        // Reset defaults button\n        if (target.id === 'reset-defaults') {\n            this.handleResetDefaults();\n            return;\n        }\n\n        // Get data-index for screen-specific actions\n        const index = target.dataset.index ? parseInt(target.dataset.index, 10) : null;\n        if (index === null) return;\n\n        // Edit button\n        if (target.classList.contains('btn-edit')) {\n            this.handleEditScreen(index);\n            return;\n        }\n\n        // Delete button\n        if (target.classList.contains('btn-danger')) {\n            this.handleDeleteScreen(index);\n            return;\n        }\n\n        // Move up button\n        if (target.classList.contains('btn-move-up')) {\n            this.handleMoveScreen(index, index - 1);\n            return;\n        }\n\n        // Move down button\n        if (target.classList.contains('btn-move-down')) {\n            this.handleMoveScreen(index, index + 1);\n            return;\n        }\n    }\n\n    /**\n     * Handle activity type change from settings dropdown\n     */\n    private handleActivityChange(e: Event): void {\n        const customEvent = e as CustomEvent<{ activityType: ActivityType; config: ActivityScreensConfig }>;\n        if (!customEvent.detail) return;\n\n        const { activityType, config } = customEvent.detail;\n\n        // Update component state\n        this.activityType = activityType;\n        this.screensConfig = config;\n\n        // Load activity-specific settings\n        this.loadActivitySettings();\n\n        // Re-render with new activity\n        this.render();\n        this.attachEventListeners();\n    }\n\n    /**\n     * Handle adding a new screen\n     */\n    private handleAddScreen(): void {\n        if (!this.screensConfig) return;\n\n        const newScreen: DataScreen = {\n            id: `screen-${Date.now()}`,\n            name: `Screen ${this.screensConfig.screens.length + 1}`,\n            icon: 'üìä',\n            slots: [],\n            layout: 'auto',\n        };\n\n        // Open editor for the new screen\n        this.openScreenEditor(newScreen, (editedScreen) => {\n            if (!this.screensConfig) return;\n            this.screensConfig.screens.push(editedScreen);\n            this.saveAndRender();\n        });\n    }\n\n    /**\n     * Handle editing a screen\n     */\n    private handleEditScreen(index: number): void {\n        if (!this.screensConfig || !this.screensConfig.screens[index]) return;\n\n        const screen = this.screensConfig.screens[index];\n\n        this.openScreenEditor(screen, (editedScreen) => {\n            if (!this.screensConfig) return;\n            this.screensConfig.screens[index] = editedScreen;\n            this.saveAndRender();\n        });\n    }\n\n    /**\n     * Open screen editor modal\n     */\n    private openScreenEditor(screen: DataScreen, onSave: (screen: DataScreen) => void): void {\n        // Get or create editor\n        if (!this.screenEditor) {\n            this.screenEditor = document.createElement('bpt-screen-editor-modal') as ScreenEditorModal;\n            document.body.appendChild(this.screenEditor);\n        }\n\n        // Open editor\n        this.screenEditor.open(screen, onSave);\n    }\n\n    /**\n     * Handle deleting a screen\n     */\n    private handleDeleteScreen(index: number): void {\n        if (!this.screensConfig || !this.screensConfig.screens[index]) return;\n\n        const screen = this.screensConfig.screens[index];\n\n        // Prevent deletion of the last screen\n        if (this.screensConfig.screens.length === 1) {\n            alert('Cannot delete the last screen. An activity must have at least one screen.');\n            return;\n        }\n\n        const confirmed = confirm(`Delete screen \"${screen.name}\"?\\n\\nThis cannot be undone.`);\n\n        if (confirmed) {\n            this.screensConfig.screens.splice(index, 1);\n\n            // Adjust activeScreenIndex if needed\n            if (this.screensConfig.activeScreenIndex >= this.screensConfig.screens.length) {\n                this.screensConfig.activeScreenIndex = Math.max(0, this.screensConfig.screens.length - 1);\n            }\n\n            this.saveAndRender();\n        }\n    }\n\n    /**\n     * Handle moving a screen\n     */\n    private handleMoveScreen(fromIndex: number, toIndex: number): void {\n        if (!this.screensConfig) return;\n\n        // Validate indices\n        if (toIndex < 0 || toIndex >= this.screensConfig.screens.length) {\n            console.warn('[ActivitySettings] Invalid move operation:', { fromIndex, toIndex });\n            return;\n        }\n\n        const screens = this.screensConfig.screens;\n        const [movedScreen] = screens.splice(fromIndex, 1);\n        screens.splice(toIndex, 0, movedScreen);\n\n        // Adjust activeScreenIndex if needed\n        if (this.screensConfig.activeScreenIndex === fromIndex) {\n            this.screensConfig.activeScreenIndex = toIndex;\n        } else if (\n            this.screensConfig.activeScreenIndex > fromIndex &&\n            this.screensConfig.activeScreenIndex <= toIndex\n        ) {\n            this.screensConfig.activeScreenIndex--;\n        } else if (\n            this.screensConfig.activeScreenIndex < fromIndex &&\n            this.screensConfig.activeScreenIndex >= toIndex\n        ) {\n            this.screensConfig.activeScreenIndex++;\n        }\n\n        this.saveAndRender();\n    }\n\n    /**\n     * Handle resetting to default screens\n     */\n    private handleResetDefaults(): void {\n        const confirmed = confirm(\n            `Reset ${this.getActivityDisplayName()} screens to defaults?\\n\\nThis will delete all custom screens and restore the defaults.`\n        );\n\n        if (confirmed) {\n            this.screensConfig = getDefaultScreensForActivity(this.activityType);\n            this.saveAndRender();\n        }\n    }\n\n    /**\n     * Save config to localStorage and re-render\n     */\n    private saveAndRender(): void {\n        if (!this.screensConfig) return;\n\n        try {\n            saveActivityScreens(this.activityType, this.screensConfig);\n\n            // Dispatch event to notify DataFieldsManager\n            const event = new CustomEvent('data-fields-activity-changed', {\n                detail: { activityType: this.activityType, config: this.screensConfig },\n                bubbles: true,\n                composed: true,\n            });\n            document.dispatchEvent(event);\n\n            this.render();\n            // Re-attach event listeners after DOM update\n            this.attachEventListeners();\n        } catch (error) {\n            console.error('[ActivitySettings] Failed to save screens:', error);\n            alert('Failed to save screen configuration. Please try again.');\n        }\n    }\n\n    /**\n     * Get display name for activity type\n     */\n    private getActivityDisplayName(): string {\n        const names: Record<ActivityType, string> = {\n            cycling: 'Cycling',\n            running: 'Running',\n            indoor: 'Indoor Cycling',\n            walking: 'Walking',\n            custom: 'Custom Activity',\n        };\n        return names[this.activityType] || 'Unknown';\n    }\n\n    /**\n     * Get the unit for auto-pause threshold based on source\n     */\n    private getAutoPauseUnit(): string {\n        switch (this.activityAutoPause.source) {\n            case 'speed':\n                return 'km/h';\n            case 'power':\n                return 'Watts';\n            case 'cadence':\n                return 'RPM';\n            default:\n                return '';\n        }\n    }\n}\n\n// Register the custom element\ncustomElements.define('bpt-activity-settings', ActivitySettingsComponent);\n"],"file":"ActivitySettingsComponent-C0XtsisF.js"}