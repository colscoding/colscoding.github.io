import{q as s,B as i}from"./feature-bluetooth-DIdcc21I.js";import{V as r}from"./index-DiG7OM9t.js";import"./vendor-core-Dob3nYDb.js";import"./feature-export-7zlEGvkQ.js";import"./vendor-leaflet-3-yx3GaH.js";class p{id=r.Debug;logArea=null;boundOnLog=this.onLog.bind(this);logBuffer=[];init(e){const o=document.getElementById("debugTemplate");if(o){const t=o.content.cloneNode(!0);e.appendChild(t),this.setupEvents(e)}else console.error("Debug template not found"),e.innerHTML="<p>Error loading debug view</p>"}onEnter(){s.addListener(this.boundOnLog)}onLeave(){s.removeListener(this.boundOnLog)}onLog(e,o){const t=new Date().toISOString();if(this.logBuffer.push({timestamp:t,sensor:e,data:o}),this.logArea){const l=t.split("T")[1].slice(0,-1);this.logArea.value+=`[${l}] ${e}: ${o}
`,this.logArea.scrollTop=this.logArea.scrollHeight}}setupEvents(e){this.logArea=e.querySelector("#debugLog");const o=e.querySelector("#connectTreadmillDebug"),t=e.querySelector("#connectRowerDebug"),l=e.querySelector("#connectConcept2Debug"),c=e.querySelector("#downloadLogs");o?.addEventListener("click",async()=>{try{this.log("System","Connecting to Treadmill..."),await i.connectTreadmill(),this.log("System","Connected to Treadmill")}catch(n){this.log("System",`Treadmill connection failed: ${n}`)}}),t?.addEventListener("click",async()=>{try{this.log("System","Connecting to Rower..."),await i.connectRowing(),this.log("System","Connected to Rower")}catch(n){this.log("System",`Rower connection failed: ${n}`)}}),l?.addEventListener("click",async()=>{try{this.log("System","Connecting to Concept2..."),await i.connectConcept2(),this.log("System","Connected to Concept2")}catch(n){this.log("System",`Concept2 connection failed: ${n}`)}}),c?.addEventListener("click",()=>{this.downloadLocalLogs()})}downloadLocalLogs(){const e=new Blob([JSON.stringify(this.logBuffer,null,2)],{type:"application/json"}),o=URL.createObjectURL(e),t=document.createElement("a");t.href=o,t.download=`bpt-debug-session-${Date.now()}.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(o)}log(e,o){if(this.logArea){const t=new Date().toISOString().split("T")[1].slice(0,-1);this.logArea.value+=`[${t}] ${e}: ${o}
`,this.logArea.scrollTop=this.logArea.scrollHeight}}}export{p as DebugView};
//# sourceMappingURL=DebugView-DEcIAOy3.js.map
