{"version":3,"file":"Modal-CCMiESK9.js","sources":["../../src/components/Modal.ts"],"sourcesContent":["/**\n * Modal Dialog Component\n *\n * A Web Component for displaying modal dialogs.\n * Fully accessible with keyboard navigation, focus trapping, and screen reader support.\n *\n * @example\n * ```html\n * <bpt-modal title=\"Confirm\" icon=\"⚠️\" open>\n *   <p>Are you sure you want to delete this workout?</p>\n *   <div slot=\"footer\">\n *     <button data-action=\"cancel\">Cancel</button>\n *     <button data-action=\"confirm\">Delete</button>\n *   </div>\n * </bpt-modal>\n * ```\n *\n * Or programmatically:\n * ```typescript\n * const result = await Modal.confirm({\n *   title: 'Delete Workout',\n *   message: 'Are you sure?',\n *   confirmText: 'Delete',\n *   variant: 'danger'\n * });\n * ```\n *\n * @module Modal\n */\n\nimport { BaseComponent } from './base/BaseComponent.js';\n\n/**\n * Button variant determines styling\n */\nexport type ButtonVariant = 'primary' | 'secondary' | 'danger';\n\n/**\n * Modal configuration for programmatic usage\n */\nexport interface ModalConfig {\n    title: string;\n    message: string | HTMLElement;\n    icon?: string;\n    confirmText?: string;\n    cancelText?: string;\n    variant?: ButtonVariant;\n    closeOnOverlay?: boolean;\n}\n\n/**\n * Modal Dialog Web Component\n */\nexport class Modal extends BaseComponent {\n    private previousActiveElement: HTMLElement | null = null;\n    private focusTrapHandler: ((e: KeyboardEvent) => void) | null = null;\n\n    static get observedAttributes(): string[] {\n        return ['title', 'icon', 'open', 'close-on-overlay'];\n    }\n\n    protected getStyles(): string {\n        return `\n            :host {\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                z-index: 1000;\n                display: none;\n                align-items: center;\n                justify-content: center;\n            }\n            \n            :host([open]) {\n                display: flex;\n            }\n            \n            .overlay {\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background-color: rgba(0, 0, 0, 0.5);\n                opacity: 0;\n                transition: opacity 0.2s ease;\n            }\n            \n            :host([open]) .overlay {\n                opacity: 1;\n            }\n            \n            .modal {\n                position: relative;\n                background: var(--modal-bg, white);\n                border-radius: 12px;\n                max-width: 90%;\n                max-height: 85vh;\n                min-width: 300px;\n                display: flex;\n                flex-direction: column;\n                box-shadow: 0 8px 24px var(--color-shadow, rgba(0, 0, 0, 0.15));\n                transform: scale(0.95) translateY(20px);\n                opacity: 0;\n                transition: transform 0.2s ease, opacity 0.2s ease;\n            }\n            \n            :host([open]) .modal {\n                transform: scale(1) translateY(0);\n                opacity: 1;\n            }\n            \n            .header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 20px 24px;\n                border-bottom: 1px solid var(--color-border, #d0d7de);\n            }\n            \n            .title {\n                font-size: 20px;\n                font-weight: 600;\n                color: var(--color-text-primary, #1f2328);\n                margin: 0;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n            }\n            \n            .icon {\n                font-size: 24px;\n            }\n            \n            .close-btn {\n                background: none;\n                border: none;\n                font-size: 24px;\n                color: var(--color-text-secondary, #656d76);\n                cursor: pointer;\n                padding: 4px;\n                border-radius: 4px;\n                transition: background-color 0.15s ease;\n                line-height: 1;\n            }\n            \n            .close-btn:hover {\n                background-color: var(--color-bg-hover, rgba(0, 0, 0, 0.05));\n            }\n            \n            .close-btn:focus-visible {\n                outline: 2px solid var(--color-accent, #2196F3);\n                outline-offset: 2px;\n            }\n            \n            .body {\n                padding: 20px 24px;\n                overflow-y: auto;\n                flex: 1;\n                color: var(--color-text-primary, #1f2328);\n            }\n            \n            .footer {\n                padding: 16px 24px;\n                border-top: 1px solid var(--color-border, #d0d7de);\n                display: flex;\n                justify-content: flex-end;\n                gap: 8px;\n            }\n            \n            ::slotted([slot=\"footer\"]) {\n                display: flex;\n                gap: 8px;\n            }\n            \n            /* Default button styles for slotted buttons */\n            .btn {\n                padding: 8px 16px;\n                border-radius: 6px;\n                font-size: 14px;\n                font-weight: 500;\n                cursor: pointer;\n                transition: background-color 0.15s ease;\n            }\n            \n            .btn-secondary {\n                background: white;\n                border: 1px solid var(--color-border, #d0d7de);\n                color: var(--color-text-primary, #1f2328);\n            }\n            \n            .btn-secondary:hover {\n                background: var(--color-bg-secondary, #f6f8fa);\n            }\n            \n            .btn-primary {\n                background: var(--color-accent, #2196F3);\n                border: none;\n                color: white;\n            }\n            \n            .btn-primary:hover {\n                background: var(--color-accent-hover, #1976d2);\n            }\n            \n            .btn-danger {\n                background: var(--color-error, #cf222e);\n                border: none;\n                color: white;\n            }\n            \n            .btn-danger:hover {\n                background: #a40e26;\n            }\n            \n            /* Reduced motion */\n            @media (prefers-reduced-motion: reduce) {\n                .overlay,\n                .modal {\n                    transition: none;\n                }\n            }\n        `;\n    }\n\n    protected getTemplate(): string {\n        const title = this.getAttribute('title') || '';\n        const icon = this.getAttribute('icon') || '';\n\n        return `\n            <div class=\"overlay\" part=\"overlay\"></div>\n            <div class=\"modal\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-title\">\n                <div class=\"header\">\n                    <h2 class=\"title\" id=\"modal-title\">\n                        ${icon ? `<span class=\"icon\" aria-hidden=\"true\">${icon}</span>` : ''}\n                        ${title}\n                    </h2>\n                    <button class=\"close-btn\" aria-label=\"Close dialog\">&times;</button>\n                </div>\n                <div class=\"body\">\n                    <slot></slot>\n                </div>\n                <div class=\"footer\">\n                    <slot name=\"footer\"></slot>\n                </div>\n            </div>\n        `;\n    }\n\n    protected setupEventListeners(): void {\n        // Close button\n        const closeBtn = this.query('.close-btn');\n        closeBtn?.addEventListener('click', () => this.close());\n\n        // Overlay click\n        const overlay = this.query('.overlay');\n        overlay?.addEventListener('click', () => {\n            if (this.getAttribute('close-on-overlay') !== 'false') {\n                this.close();\n            }\n        });\n\n        // Escape key\n        this.addEventListener('keydown', (e: KeyboardEvent) => {\n            if (e.key === 'Escape') {\n                this.close();\n            }\n        });\n\n        // Button actions in footer\n        this.addEventListener('click', (e: Event) => {\n            const target = e.target as HTMLElement;\n            const action = target.dataset?.action;\n            if (action) {\n                this.emit('modal-action', { action });\n                if (action === 'cancel' || action === 'confirm') {\n                    this.close();\n                }\n            }\n        });\n    }\n\n    protected onConnected(): void {\n        if (this.hasAttribute('open')) {\n            this.onOpen();\n        }\n    }\n\n    protected onAttributeChanged(name: string, _oldValue: string | null, newValue: string | null): void {\n        if (name === 'open') {\n            if (newValue !== null) {\n                this.onOpen();\n            } else {\n                this.onClose();\n            }\n        }\n    }\n\n    /**\n     * Called when modal opens\n     */\n    private onOpen(): void {\n        this.previousActiveElement = document.activeElement as HTMLElement;\n        this.setupFocusTrap();\n\n        // Focus first focusable element\n        requestAnimationFrame(() => {\n            const firstFocusable = this.shadow.querySelector<HTMLElement>(\n                'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n            );\n            firstFocusable?.focus();\n        });\n\n        this.emit('modal-open');\n    }\n\n    /**\n     * Called when modal closes\n     */\n    private onClose(): void {\n        this.removeFocusTrap();\n        this.previousActiveElement?.focus();\n        this.emit('modal-close');\n    }\n\n    /**\n     * Set up focus trap\n     */\n    private setupFocusTrap(): void {\n        this.focusTrapHandler = (e: KeyboardEvent) => {\n            if (e.key !== 'Tab') return;\n\n            const focusableElements = this.shadow.querySelectorAll<HTMLElement>(\n                'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n            );\n            const first = focusableElements[0];\n            const last = focusableElements[focusableElements.length - 1];\n\n            if (e.shiftKey && document.activeElement === first) {\n                e.preventDefault();\n                last?.focus();\n            } else if (!e.shiftKey && document.activeElement === last) {\n                e.preventDefault();\n                first?.focus();\n            }\n        };\n\n        this.addEventListener('keydown', this.focusTrapHandler);\n    }\n\n    /**\n     * Remove focus trap\n     */\n    private removeFocusTrap(): void {\n        if (this.focusTrapHandler) {\n            this.removeEventListener('keydown', this.focusTrapHandler);\n            this.focusTrapHandler = null;\n        }\n    }\n\n    /**\n     * Open the modal\n     */\n    public open(): void {\n        this.setAttribute('open', '');\n    }\n\n    /**\n     * Close the modal\n     */\n    public close(): void {\n        this.removeAttribute('open');\n    }\n\n    /**\n     * Toggle modal visibility\n     */\n    public toggle(): void {\n        if (this.hasAttribute('open')) {\n            this.close();\n        } else {\n            this.open();\n        }\n    }\n\n    /**\n     * Static method to show a confirmation dialog\n     */\n    static confirm(config: ModalConfig): Promise<boolean> {\n        return new Promise((resolve) => {\n            const modal = document.createElement('bpt-modal') as Modal;\n            modal.setAttribute('title', config.title);\n            if (config.icon) {\n                modal.setAttribute('icon', config.icon);\n            }\n\n            // Set content\n            const content = document.createElement('div');\n            if (typeof config.message === 'string') {\n                content.innerHTML = `<p>${config.message}</p>`;\n            } else {\n                content.appendChild(config.message);\n            }\n            modal.appendChild(content);\n\n            // Create footer with buttons\n            const footer = document.createElement('div');\n            footer.setAttribute('slot', 'footer');\n\n            const cancelBtn = document.createElement('button');\n            cancelBtn.className = 'btn btn-secondary';\n            cancelBtn.textContent = config.cancelText || 'Cancel';\n            cancelBtn.dataset.action = 'cancel';\n\n            const confirmBtn = document.createElement('button');\n            confirmBtn.className = `btn btn-${config.variant || 'primary'}`;\n            confirmBtn.textContent = config.confirmText || 'Confirm';\n            confirmBtn.dataset.action = 'confirm';\n\n            footer.appendChild(cancelBtn);\n            footer.appendChild(confirmBtn);\n            modal.appendChild(footer);\n\n            // Handle actions\n            modal.addEventListener('modal-action', ((e: CustomEvent) => {\n                resolve(e.detail.action === 'confirm');\n                modal.remove();\n            }) as EventListener);\n\n            modal.addEventListener('modal-close', () => {\n                resolve(false);\n                modal.remove();\n            });\n\n            document.body.appendChild(modal);\n            modal.open();\n        });\n    }\n\n    /**\n     * Static method to show an alert dialog\n     */\n    static alert(title: string, message: string, icon?: string): Promise<void> {\n        return new Promise((resolve) => {\n            const modal = document.createElement('bpt-modal') as Modal;\n            modal.setAttribute('title', title);\n            if (icon) {\n                modal.setAttribute('icon', icon);\n            }\n\n            const content = document.createElement('p');\n            content.textContent = message;\n            modal.appendChild(content);\n\n            const footer = document.createElement('div');\n            footer.setAttribute('slot', 'footer');\n\n            const okBtn = document.createElement('button');\n            okBtn.className = 'btn btn-primary';\n            okBtn.textContent = 'OK';\n            okBtn.dataset.action = 'confirm';\n            footer.appendChild(okBtn);\n            modal.appendChild(footer);\n\n            modal.addEventListener('modal-close', () => {\n                resolve();\n                modal.remove();\n            });\n\n            document.body.appendChild(modal);\n            modal.open();\n        });\n    }\n}\n\n// Register the custom element\ncustomElements.define('bpt-modal', Modal);\n\n// Export for type-safe usage\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'bpt-modal': Modal;\n    }\n}\n"],"names":["Modal","BaseComponent","title","icon","e","action","name","_oldValue","newValue","focusableElements","first","last","config","resolve","modal","content","footer","cancelBtn","confirmBtn","message","okBtn"],"mappings":"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"}