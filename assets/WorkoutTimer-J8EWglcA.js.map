{"version":3,"file":"WorkoutTimer-J8EWglcA.js","sources":["../../src/components/WorkoutTimer.ts"],"sourcesContent":["/**\n * Workout Timer Component\n *\n * A Web Component for displaying workout elapsed time.\n * Supports different states: idle, recording, paused.\n *\n * @example\n * ```html\n * <bpt-workout-timer\n *   elapsed=\"3661\"\n *   state=\"recording\">\n * </bpt-workout-timer>\n * ```\n *\n * @module WorkoutTimer\n */\n\nimport { BaseComponent } from './base/BaseComponent.js';\n\n/**\n * Workout state enum\n */\nexport type WorkoutTimerState = 'idle' | 'recording' | 'paused';\n\n/**\n * Workout Timer Web Component\n */\nexport class WorkoutTimer extends BaseComponent {\n    private intervalId: number | null = null;\n    private startTimestamp = 0;\n    private pausedElapsed = 0;\n\n    static get observedAttributes(): string[] {\n        return ['elapsed', 'state', 'show-milliseconds'];\n    }\n\n    protected getStyles(): string {\n        return `\n            :host {\n                display: inline-flex;\n                align-items: center;\n                justify-content: center;\n                font-family: 'SF Mono', 'Monaco', 'Menlo', monospace;\n            }\n            \n            .timer {\n                font-size: clamp(20px, 5vw, 32px);\n                font-weight: 600;\n                color: var(--color-text-primary, #1f2328);\n                letter-spacing: 0.5px;\n                transition: color 0.3s ease;\n            }\n            \n            :host([state=\"recording\"]) .timer {\n                color: var(--color-success, #15803d);\n            }\n            \n            :host([state=\"paused\"]) .timer {\n                color: var(--color-warning, #a16207);\n                animation: blink 1s ease-in-out infinite;\n            }\n            \n            :host([state=\"idle\"]) .timer {\n                color: var(--color-text-muted, #8b949e);\n            }\n            \n            .milliseconds {\n                font-size: 0.5em;\n                opacity: 0.7;\n            }\n            \n            @keyframes blink {\n                0%, 100% { opacity: 1; }\n                50% { opacity: 0.5; }\n            }\n            \n            /* Reduced motion */\n            @media (prefers-reduced-motion: reduce) {\n                :host([state=\"paused\"]) .timer {\n                    animation: none;\n                }\n            }\n        `;\n    }\n\n    protected getTemplate(): string {\n        const elapsed = parseInt(this.getAttribute('elapsed') || '0', 10);\n        const showMs = this.hasAttribute('show-milliseconds');\n        const timeString = this.formatTime(elapsed, showMs);\n\n        return `\n            <time class=\"timer\" datetime=\"PT${elapsed}S\" aria-live=\"off\">\n                ${timeString}\n            </time>\n        `;\n    }\n\n    /**\n     * Format elapsed seconds to HH:MM:SS or HH:MM:SS.ms\n     */\n    private formatTime(totalSeconds: number, showMs = false): string {\n        const hours = Math.floor(totalSeconds / 3600);\n        const minutes = Math.floor((totalSeconds % 3600) / 60);\n        const seconds = Math.floor(totalSeconds % 60);\n\n        const pad = (n: number) => n.toString().padStart(2, '0');\n        let result = `${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;\n\n        if (showMs) {\n            const ms = Math.floor((totalSeconds % 1) * 100);\n            result += `<span class=\"milliseconds\">.${pad(ms)}</span>`;\n        }\n\n        return result;\n    }\n\n    protected onAttributeChanged(name: string): void {\n        if (name === 'state') {\n            this.handleStateChange();\n        }\n        this.render();\n    }\n\n    /**\n     * Handle state changes\n     */\n    private handleStateChange(): void {\n        const state = this.getAttribute('state') as WorkoutTimerState;\n\n        if (state === 'recording' && !this.intervalId) {\n            this.startTicking();\n        } else if (state !== 'recording' && this.intervalId) {\n            this.stopTicking();\n        }\n    }\n\n    /**\n     * Start the internal tick\n     */\n    private startTicking(): void {\n        this.startTimestamp = Date.now() - this.pausedElapsed * 1000;\n        this.intervalId = window.setInterval(() => {\n            const elapsed = (Date.now() - this.startTimestamp) / 1000;\n            this.setAttribute('elapsed', String(elapsed));\n        }, 100);\n    }\n\n    /**\n     * Stop the internal tick\n     */\n    private stopTicking(): void {\n        if (this.intervalId) {\n            clearInterval(this.intervalId);\n            this.intervalId = null;\n        }\n        this.pausedElapsed = parseFloat(this.getAttribute('elapsed') || '0');\n    }\n\n    protected onDisconnected(): void {\n        this.stopTicking();\n    }\n\n    /**\n     * Start the timer\n     */\n    public start(): void {\n        this.setAttribute('state', 'recording');\n        this.emit('timer-start');\n    }\n\n    /**\n     * Pause the timer\n     */\n    public pause(): void {\n        this.setAttribute('state', 'paused');\n        this.emit('timer-pause');\n    }\n\n    /**\n     * Resume the timer\n     */\n    public resume(): void {\n        this.setAttribute('state', 'recording');\n        this.emit('timer-resume');\n    }\n\n    /**\n     * Stop and reset the timer\n     */\n    public stop(): void {\n        this.setAttribute('state', 'idle');\n        this.pausedElapsed = 0;\n        this.emit('timer-stop', { elapsed: parseFloat(this.getAttribute('elapsed') || '0') });\n    }\n\n    /**\n     * Reset the timer to zero\n     */\n    public reset(): void {\n        this.pausedElapsed = 0;\n        this.startTimestamp = Date.now();\n        this.setAttribute('elapsed', '0');\n        this.emit('timer-reset');\n    }\n\n    /**\n     * Get the current elapsed time in seconds\n     */\n    public getElapsed(): number {\n        return parseFloat(this.getAttribute('elapsed') || '0');\n    }\n\n    /**\n     * Get the current state\n     */\n    public getState(): WorkoutTimerState {\n        return (this.getAttribute('state') as WorkoutTimerState) || 'idle';\n    }\n}\n\n// Register the custom element\ncustomElements.define('bpt-workout-timer', WorkoutTimer);\n\n// Export for type-safe usage\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'bpt-workout-timer': WorkoutTimer;\n    }\n}\n"],"names":["WorkoutTimer","BaseComponent","elapsed","showMs","timeString","totalSeconds","hours","minutes","seconds","pad","n","result","ms","name","state"],"mappings":"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"}