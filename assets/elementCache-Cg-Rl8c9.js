class d{cache=new Map;shadowCache=new Map;get(e,n=document){const c=this.cache.get(e);if(c){const s=c.deref();if(s&&s.isConnected)return s;this.cache.delete(e)}const t=n.querySelector(e);return t&&this.cache.set(e,new WeakRef(t)),t}getShadow(e,n){const c=e.shadowRoot;if(!c)return null;let t=this.shadowCache.get(e);t||(t=new Map,this.shadowCache.set(e,t));const s=t.get(n);if(s){const o=s.deref();if(o&&o.isConnected)return o;t.delete(n)}const a=c.querySelector(n);return a&&t.set(n,new WeakRef(a)),a}clear(e){e?this.cache.delete(e):(this.cache.clear(),this.shadowCache.clear())}invalidate(){for(const[e,n]of this.cache){const c=n.deref();(!c||!c.isConnected)&&this.cache.delete(e)}for(const[e,n]of this.shadowCache){if(!e.isConnected){this.shadowCache.delete(e);continue}for(const[c,t]of n){const s=t.deref();(!s||!s.isConnected)&&n.delete(c)}}}}const i=new d;typeof document<"u"&&typeof MutationObserver<"u"&&new MutationObserver(()=>{"requestIdleCallback"in window?window.requestIdleCallback(()=>i.invalidate()):setTimeout(()=>i.invalidate(),1e3)}).observe(document.body,{childList:!0,subtree:!0});export{i as e};
//# sourceMappingURL=elementCache-Cg-Rl8c9.js.map
